{"version":3,"sources":["../src/index.ts","../src/shared/utils/getEnv.ts","../src/config/db.ts","../src/config/server.ts","../src/shared/constants/index.ts","../src/shared/middleware/error.ts","../src/shared/middleware/validate.ts","../src/features/auth/middleware.ts","../src/shared-types/auth/validators.ts","../src/shared-types/auth/api.ts","../src/shared-types/auth/constants.ts","../src/features/payments/controller.ts","../src/config/app.config.ts","../src/config/firebase.ts","../src/shared/utils/helpers.ts","../src/shared/utils/pagination.ts","../src/shared/utils/response.ts","../src/shared/models/user.model.ts","../src/shared/models/constants.ts","../src/shared/models/tuition.model.ts","../src/shared/models/application.model.ts","../src/shared/models/payment.model.ts","../src/shared/models/review.model.ts","../src/features/payments/model.ts","../src/shared-types/payments/api.ts","../src/features/payments/routes.ts","../src/features/dashboard/index.ts","../src/shared-types/dashboard/shared.ts","../src/features/dashboard/shared.controller.ts","../src/features/dashboard/admin/controller.ts","../src/features/dashboard/admin/routes.ts","../src/shared-types/dashboard/admin.ts","../src/features/dashboard/student/controller.ts","../src/features/dashboard/student/routes.ts","../src/shared-types/dashboard/student.ts","../src/features/dashboard/tutor/controller.ts","../src/features/dashboard/tutor/routes.ts","../src/shared-types/dashboard/tutor.ts","../src/features/public/routes.ts","../src/shared-types/public/index.ts","../src/features/public/controller.ts","../src/features/reviews/routes.ts","../src/shared-types/reviews/validators.ts","../src/shared-types/reviews/index.ts","../src/features/reviews/controller.ts","../src/features/auth/routes.ts","../src/features/auth/controller.ts"],"sourcesContent":["import 'dotenv/config.js'\nimport { Server } from \"./config/server.js\";\nimport express, { type Express } from 'express';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport compression from \"compression\";\nimport { getEnv } from \"./shared/utils/getEnv.js\";\nimport cookieParser from \"cookie-parser\";\nimport { errorHandler, notFoundHandler } from './shared/middleware/index.js';\nimport { paymentsRouter } from './features/payments/index.js';\nimport { dashboardRouter } from './features/dashboard/index.js';\nimport { publicRoutes } from './features/public/index.js';\nimport { reviewRouter } from './features/reviews/index.js';\nimport authRouter from './features/auth/routes.js';\nimport { firebase } from './config/firebase.js';\n\n// Initialize Firebase Admin SDK\nfirebase.init();\n\nconst app: Express = express()\n\n//Security Middleware\napp.use(helmet())\napp.use(compression())\n\n// Database connection middleware for serverless (Vercel)\nimport { db } from './config/db.js';\napp.use(async (req, res, next) => {\n    try {\n        await db.connect();\n        next();\n    } catch (error) {\n        console.error('Database connection error:', error);\n        res.status(500).json({ success: false, message: 'Database connection failed' });\n    }\n});\n\n//CORS Configuration\nconst allowedOrigins = [\n    getEnv.string('CLIENT_URL', 'http://localhost:3000'),\n    'https://e-tuitionbd.netlify.app',\n    'http://localhost:3000',\n    'http://localhost:5173'\n].map(url => url.replace(/\\/$/, '')); // Remove trailing slashes\n\napp.use(cors({\n    origin: (origin, callback) => {\n        // Allow requests with no origin (like mobile apps, Postman, curl)\n        if (!origin) return callback(null, true);\n\n        // Normalize origin by removing trailing slash\n        const normalizedOrigin = origin.replace(/\\/$/, '');\n\n        if (allowedOrigins.some(allowed => normalizedOrigin === allowed)) {\n            callback(null, true);\n        } else {\n            callback(new Error('Not allowed by CORS'));\n        }\n    },\n    credentials: true,\n}))\n\n//Request Parsing\napp.use(express.json())\napp.use(express.urlencoded({ extended: true }))\n\n//Cookie Parser\napp.use(cookieParser())\n\n// ==================== Request Logging ====================\nlet requestCounter = 0;\nconst requestLog: Record<string, number> = {};\n\napp.use((req, res, next) => {\n    requestCounter++;\n    const endpoint = `${req.method} ${req.path}`;\n    requestLog[endpoint] = (requestLog[endpoint] || 0) + 1;\n\n    const timestamp = new Date().toLocaleTimeString();\n    console.log(`[${timestamp}] #${requestCounter} ${endpoint} (${requestLog[endpoint]}x)`);\n    next();\n});\n\n// ==================== API Routes ====================\nconst API_BASE = '/api/v1';\napp.use(API_BASE, authRouter);       // Auth (register, login, logout, etc.)\napp.use(API_BASE, publicRoutes);     // Public (tuitions, tutors browsing)\napp.use(API_BASE, dashboardRouter);  // Dashboard (admin, student, tutor)\napp.use(API_BASE, reviewRouter);     // Reviews (tutor reviews)\napp.use(API_BASE, paymentsRouter);   // Payments (Stripe)\n\n// ==================== Error Handling ====================\napp.use(notFoundHandler);\napp.use(errorHandler);\n\n// Start server (only in non-Vercel environment)\nif (process.env.VERCEL !== '1') {\n    await Server.start(app);\n}\n\n// Export for Vercel\nexport default app;\n","export const getEnv = {\n\tstring: (key: string, fallback?: string): string => {\n\t\tconst value = process.env[key] ?? fallback;\n\t\tif (value === undefined) {\n\t\t\tthrow new Error(`Environment variable ${key} is not defined`);\n\t\t}\n\t\t// Trim whitespace and control characters\n\t\treturn value.trim();\n\t},\n\n\tnumber: (key: string, fallback?: number): number =>\n\t\t(process.env[key] !== undefined ? Number(process.env[key]) : fallback) ?? (() => {\n\t\t\tthrow new Error(`Environment variable ${key} is not defined`);\n\t\t})(),\n\n\tboolean: (key: string, fallback?: boolean): boolean =>\n\t\t(process.env[key] !== undefined\n\t\t\t? process.env[key]!.toLowerCase() === 'true' || process.env[key] === '1'\n\t\t\t: fallback) ?? (() => {\n\t\t\t\tthrow new Error(`Environment variable ${key} is not defined`);\n\t\t\t})(),\n\n\tmultiple: (keys: string[]): Record<string, string> => {\n\t\tconst result: Record<string, string> = {};\n\t\tfor (const key of keys) result[key] = getEnv.string(key);\n\t\treturn result;\n\t}\n};","import { getEnv } from \"@/shared/utils/getEnv.js\";\nimport { Db, MongoClient, ServerApiVersion } from \"mongodb\";\n\nexport class db {\n    static #db: Db | null = null;\n    static #client: MongoClient | null = null;\n    static #MONGODB_URI = getEnv.string('MONGODB_URI');\n    static #DBNAME = getEnv.string(\"DB_NAME\")\n\n    // ==================== Connect to this ====================\n    static async connect(): Promise<Db> {\n        if (this.#db) return this.#db;\n\n        if (!this.#MONGODB_URI) {\n            throw new Error(\"MONGODB_URI is not defined in environment variables\");\n        }\n\n        try {\n            this.#client = new MongoClient(this.#MONGODB_URI, {\n                serverApi: {\n                    version: ServerApiVersion.v1,\n                    strict: true,\n                    deprecationErrors: true,\n                },\n            });\n\n            await this.#client.connect();\n            await this.#client.db(\"admin\").command({ ping: 1 });\n\n            this.#db = this.#client.db(this.#DBNAME);\n\n            this.logs.connect.success()\n            return this.#db;\n\n        } catch (error) {\n            this.logs.connect.failed(error)\n            throw error;\n        }\n    }\n\n    // ==================== Get this Instance ====================\n    static getDB(): Db {\n        if (!this.#db) {\n            throw new Error(\"this not initialized. Call this.connect() first.\");\n        }\n        return this.#db;\n    }\n\n    // ==================== Close this Connection ====================\n    static async close(): Promise<void> {\n        try {\n            if (this.#client) {\n                await this.#client.close();\n                this.#db = null;\n                this.#client = null;\n                this.logs.close.success();\n            }\n        } catch (err) {\n            this.logs.close.failed(err)\n            throw err\n        }\n    }\n\n    static logs = {\n        connect: {\n            success: () => {\n                console.log(\"âœ… Successfully connected to MongoDB!\");\n                console.log(`ðŸ“¦ this: ${this.#DBNAME}`);\n            },\n            failed: (err: unknown) => console.error(\"âŒ MongoDB connection error:\", err)\n        },\n        close: {\n            success: () => console.log(\"ðŸ“¤ Database connection closed\"),\n            failed: (err: unknown) => console.error(\"âŒ Error closing database connection:\", err)\n        }\n    }\n}\n\n","import type { Express } from \"express\";\nimport { getEnv } from \"@/shared/utils/getEnv.js\";\nimport { db } from \"./db.js\";\n\nexport class Server {\n    static #PORT = getEnv.number('PORT', 5000)\n    static #CLIENT = getEnv.string('CLIENT_URL', 'http://localhost:3000')\n    static #API_BASE = 'api/v1'\n\n    static async start(app: Express) {\n        try {\n            await db.connect()\n            app.listen(this.#PORT, () => {\n                this.logs.start.success()\n            })\n        } catch (err) {\n            const message = err instanceof Error ? err.message : String(err)\n            this.logs.start.failed(message)\n            process.exit(1)\n        }\n    }\n\n    static logs = {\n        start: {\n            success: () => {\n                console.log(`ðŸš€ Server running on port ${this.#PORT}`)\n                console.log(`ðŸŒ Client URL: ${this.#CLIENT}`)\n                console.log(`ðŸ“¡ API Base: ${this.#API_BASE}`)\n            },\n            failed: (err = '') =>\n                console.error(\"âŒ Failed to start server:\", err)\n        }\n    }\n}\n","// ==================== Shared Constants ====================\n// HTTP Status, Error Messages, Success Messages\n\n// ==================== HTTP Status Codes ====================\nexport const HTTP_STATUS = {\n    OK: 200,\n    CREATED: 201,\n    NO_CONTENT: 204,\n    BAD_REQUEST: 400,\n    UNAUTHORIZED: 401,\n    FORBIDDEN: 403,\n    NOT_FOUND: 404,\n    CONFLICT: 409,\n    UNPROCESSABLE_ENTITY: 422,\n    TOO_MANY_REQUESTS: 429,\n    INTERNAL_SERVER_ERROR: 500,\n    SERVICE_UNAVAILABLE: 503,\n} as const;\n\n// ==================== Error Messages ====================\nexport const ERROR_MESSAGES = {\n    UNAUTHORIZED: \"Unauthorized. Please log in to continue.\",\n    FORBIDDEN: \"You do not have permission to perform this action.\",\n    NOT_FOUND: \"Resource not found.\",\n    INVALID_TOKEN: \"Invalid or expired token.\",\n    NO_TOKEN: \"No token provided.\",\n    INVALID_CREDENTIALS: \"Invalid credentials.\",\n    USER_EXISTS: \"User already exists with this email.\",\n    INVALID_ROLE: \"Invalid role. Must be student, tutor, or admin.\",\n    VALIDATION_ERROR: \"Validation error. Please check your input.\",\n    SERVER_ERROR: \"Internal server error. Please try again later.\",\n    DATABASE_ERROR: \"Database error. Please try again later.\",\n} as const;\n\n// ==================== Success Messages ====================\nexport const SUCCESS_MESSAGES = {\n    LOGIN: \"Login successful.\",\n    REGISTER: \"Registration successful.\",\n    LOGOUT: \"Logout successful.\",\n    CREATED: \"Resource created successfully.\",\n    UPDATED: \"Resource updated successfully.\",\n    DELETED: \"Resource deleted successfully.\",\n    FETCHED: \"Data fetched successfully.\",\n    PROFILE_UPDATE: \"Profile updated successfully.\",\n    ROLE_UPDATE: \"User role updated successfully.\",\n    TUITION_CREATED: \"Tuition posted successfully.\",\n    TUITION_UPDATED: \"Tuition updated successfully.\",\n    TUITION_DELETED: \"Tuition deleted successfully.\",\n    TUITIONS_FETCHED: \"Tuitions fetched successfully.\",\n    APPLICATION_SUBMITTED: \"Application submitted successfully.\",\n    APPLICATION_UPDATED: \"Application updated successfully.\",\n    PAYMENT_SUCCESS: \"Payment completed successfully.\",\n} as const;\n","// ==================== Error Middleware ====================\nimport type { NextFunction, Request, Response } from \"express\";\nimport type { AuthRequest } from \"../../features/auth/types.js\";\nimport { HTTP_STATUS } from \"../constants/index.js\";\n\n// ==================== Custom App Error ====================\nexport class AppError extends Error {\n  statusCode: number;\n  isOperational: boolean;\n\n  constructor(message: string, statusCode: number = 500) {\n    super(message);\n    this.statusCode = statusCode;\n    this.isOperational = true;\n\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\n\n// ==================== Async Handler ====================\nexport const asyncHandler = (\n  fn: (req: AuthRequest, res: Response, next: NextFunction) => Promise<void>\n) => {\n  return (req: Request, res: Response, next: NextFunction): void => {\n    Promise.resolve(fn(req as AuthRequest, res, next)).catch(next);\n  };\n};\n\n// ==================== Not Found Handler ====================\nexport const notFoundHandler = (\n  req: Request,\n  res: Response,\n  _next: NextFunction\n): void => {\n  res.status(HTTP_STATUS.NOT_FOUND).json({\n    success: false,\n    message: `Route not found: ${req.method} ${req.originalUrl}`,\n  });\n};\n\n// ==================== Global Error Handler ====================\nexport const errorHandler = (\n  err: Error | AppError,\n  _req: Request,\n  res: Response,\n  _next: NextFunction\n): void => {\n  const statusCode =\n    err instanceof AppError\n      ? err.statusCode\n      : HTTP_STATUS.INTERNAL_SERVER_ERROR;\n  const message = err.message || \"Internal Server Error\";\n\n  console.error(`[Error] ${statusCode}: ${message}`);\n  if (process.env.NODE_ENV === \"development\") {\n    console.error(err.stack);\n  }\n\n  res.status(statusCode).json({\n    success: false,\n    message,\n    ...(process.env.NODE_ENV === \"development\" && { stack: err.stack }),\n  });\n};\n","// ==================== Validation Middleware ====================\nimport type { NextFunction, Request, Response } from \"express\";\nimport { ZodSchema, ZodError, ZodIssue } from \"zod\";\nimport { HTTP_STATUS } from \"../constants/index.js\";\n\n// ==================== Validate Request Body ====================\nexport const validateBody = (schema: ZodSchema) => {\n    return (req: Request, res: Response, next: NextFunction): void => {\n\n        const result = schema.safeParse(req.body);\n\n        if (!result.success) {\n            const zodError = result.error as ZodError;\n            res.status(HTTP_STATUS.BAD_REQUEST).json({\n                success: false,\n                message: \"Validation error\",\n                errors: zodError.issues.map((err: ZodIssue) => ({\n                    field: err.path.join(\".\"),\n                    message: err.message,\n                })),\n            });\n            return;\n        }\n\n        req.body = result.data;\n        next();\n    };\n};\n\n// ==================== Validate Request Params ====================\nexport const validateParams = (schema: ZodSchema) => {\n    return (req: Request, res: Response, next: NextFunction): void => {\n        const result = schema.safeParse(req.params);\n\n        if (!result.success) {\n            const zodError = result.error as ZodError;\n            res.status(HTTP_STATUS.BAD_REQUEST).json({\n                success: false,\n                message: \"Invalid parameters\",\n                errors: zodError.issues.map((err: ZodIssue) => ({\n                    field: err.path.join(\".\"),\n                    message: err.message,\n                })),\n            });\n            return;\n        }\n\n        next();\n    };\n};\n\n// ==================== Validate Request Query ====================\nexport const validateQuery = (schema: ZodSchema) => {\n    return (req: Request, res: Response, next: NextFunction): void => {\n        const result = schema.safeParse(req.query);\n\n        if (!result.success) {\n            const zodError = result.error as ZodError;\n            res.status(HTTP_STATUS.BAD_REQUEST).json({\n                success: false,\n                message: \"Invalid query parameters\",\n                errors: zodError.issues.map((err: ZodIssue) => ({\n                    field: err.path.join(\".\"),\n                    message: err.message,\n                })),\n            });\n            return;\n        }\n\n        next();\n    };\n};\n","// ==================== Authentication Middleware ====================\nimport type { CookieOptions, NextFunction, Response } from \"express\";\nimport jwt from \"jsonwebtoken\";\nimport { ROLES } from \"@/shared-types/auth/index.js\";\n\nimport { ERROR_MESSAGES, HTTP_STATUS } from \"../../shared/constants/index.js\";\nimport type { IUser } from \"../../shared/models/types.js\";\nimport type { AuthRequest } from \"./types.js\";\nimport { firebase } from \"@/config/firebase.js\";\nimport { getEnv } from \"@/shared/utils/getEnv.js\";\nimport { db } from \"@/config/db.js\";\n\n// ==================== Cookie Options ====================\n\n// ==================== Extract Token ====================\nconst extractToken = (req: AuthRequest): string | null => {\n\t// Priority 1: HTTP-only cookie\n\tconst cookieToken = req.cookies?.['auth_token'];\n\tif (cookieToken) return cookieToken;\n\n\t// Priority 2: Authorization header (for Firebase tokens and backward compatibility)\n\tconst authHeader = req.headers.authorization;\n\tif (authHeader?.startsWith(\"Bearer \")) {\n\t\treturn authHeader.split(\"Bearer \")[1];\n\t}\n\n\treturn null;\n};\n\n// ==================== Verify Firebase or JWT Token ====================\nexport const authMiddleware = async (req: AuthRequest, res: Response, next: NextFunction): Promise<void> => {\n\tconst token = extractToken(req);\n\n\tif (!token) {\n\t\tres.status(HTTP_STATUS.UNAUTHORIZED).json({ success: false, message: ERROR_MESSAGES.NO_TOKEN, });\n\t\treturn;\n\t}\n\n\ttry {\n\t\treq.user = jwt.verify(token, getEnv.string('JWT_SECRET')) as { email: string; role: \"student\" | \"tutor\" | \"admin\"; };\n\t\treturn next();\n\t} catch {\n\t\tres.status(HTTP_STATUS.UNAUTHORIZED).json({ success: false, message: ERROR_MESSAGES.INVALID_TOKEN, });\n\t\treturn;\n\t}\n};\n\n\ntype UserRole = (typeof ROLES)[keyof typeof ROLES];\n\nexport const requireRole = (...roles: UserRole[]) => {\n\treturn async (\n\t\treq: AuthRequest,\n\t\tres: Response,\n\t\tnext: NextFunction\n\t): Promise<void> => {\n\t\ttry {\n\t\t\tif (!req.user || !req.user.email) {\n\t\t\t\tres.status(HTTP_STATUS.UNAUTHORIZED).json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tmessage: ERROR_MESSAGES.UNAUTHORIZED,\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst database = await db.getDB();\n\t\t\tconst user = await database\n\t\t\t\t.collection<IUser>('users')\n\t\t\t\t.findOne({ email: req.user.email });\n\n\t\t\tif (!user) {\n\t\t\t\tres.status(HTTP_STATUS.UNAUTHORIZED).json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tmessage: \"User not found in database.\",\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst userRole = user.role.trim() as UserRole;\n\n\t\t\tif (!roles.includes(userRole)) {\n\t\t\t\tres.status(HTTP_STATUS.FORBIDDEN).json({\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tmessage: ERROR_MESSAGES.FORBIDDEN,\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Attach role safely\n\t\t\treq.user = { ...req.user, role: user.role };\n\n\t\t\tnext();\n\t\t} catch (error) {\n\t\t\tres.status(HTTP_STATUS.INTERNAL_SERVER_ERROR).json({\n\t\t\t\tsuccess: false,\n\t\t\t\tmessage: ERROR_MESSAGES.SERVER_ERROR,\n\t\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t\t});\n\t\t}\n\t};\n};\n\n\nexport const adminMiddleware = requireRole(ROLES.ADMIN);\nexport const studentMiddleware = requireRole(ROLES.STUDENT);\nexport const tutorMiddleware = requireRole(ROLES.TUTOR);\nexport const studentOrTutorMiddleware = requireRole(ROLES.STUDENT, ROLES.TUTOR);\nexport const anyRoleMiddleware = requireRole(ROLES.STUDENT, ROLES.TUTOR, ROLES.ADMIN);\nexport const guestMiddleware = (req: AuthRequest, res: Response, next: NextFunction): void => {\n\tconst cookieToken = req.cookies?.['auth_token'];\n\tif (cookieToken) {\n\t\t// Verify if token is valid\n\t\ttry {\n\t\t\tjwt.verify(cookieToken, getEnv.string('JWT_SECRET'));\n\t\t\t// Token is valid, user is authenticated\n\t\t\tres.status(403).json({ message: `Already authenticated users cannot access this route` });\n\t\t\treturn;\n\t\t} catch {\n\t\t\t// Token is invalid/expired, clear it and allow access\n\t\t\tres.clearCookie(\"auth_token\", {\n\t\t\t\thttpOnly: true,\n\t\t\t\tsecure: process.env.NODE_ENV === 'production',\n\t\t\t\tsameSite: process.env.NODE_ENV === 'production' ? \"none\" : \"lax\"\n\t\t\t});\n\t\t}\n\t}\n\tnext();\n}\n\n// ==================== Generate JWT ====================\nexport const generateJWT = (payload: { email: string; role: string }): string => {\n\treturn jwt.sign(payload, getEnv.string('JWT_SECRET'), { expiresIn: '7d' });\n};\n\n// ==================== Verify JWT ====================\nexport const verifyJWT = (token: string): { email: string; role: string } | null => {\n\ttry {\n\t\treturn jwt.verify(token, getEnv.string('JWT_SECRET')) as { email: string; role: string };\n\t} catch {\n\t\treturn null;\n\t}\n};\n\n// ==================== Optional Auth Middleware ====================\nexport const optionalAuth = async (req: AuthRequest, _res: Response, next: NextFunction): Promise<void> => {\n\tconst token = extractToken(req);\n\tif (token) {\n\t\ttry {\n\t\t\treq.user = jwt.verify(token, getEnv.string('JWT_SECRET')) as { email: string; role: \"student\" | \"tutor\" | \"admin\" };\n\t\t} catch {\n\t\t\t// Token invalid, continue without user\n\t\t}\n\t}\n\tnext();\n};","import { z } from \"zod\";\n\nexport type SignInCreds = z.infer<typeof SignInSchema>\nexport const SignInSchema = z.object({\n    email: z.email({ message: \"Email is required\" }),\n\n    password: z.string().min(8, \"Password must be at least 8 characters\")\n})\n\nexport type SignUpCreds = z.infer<typeof SignUpSchema>\nexport const SignUpSchema = z.object({\n    name: z.string()\n        .min(1, \"Name is required\")\n        .max(50, \"Name must be at most 50 characters\"),\n\n    email: z.email({ message: \"Email is required\" }),\n\n    phone: z.string()\n        .min(10, \"Phone number must be at least 10 digits\")\n        .max(15, \"Phone number must be at most 15 digits\")\n        .regex(/^01[3-9][0-9]{8}$/, \"Phone number must contain only digits\"),\n\n    role: z.enum([\"student\", \"tutor\"], {\n        message: \"Role is required and must be student or tutor\",\n    }),\n\n    password: z.string()\n        .min(8, \"Password must be at least 8 characters\")\n        .regex(/[A-Z]/, \"Password must contain at least one uppercase letter\")\n        .regex(/[a-z]/, \"Password must contain at least one lowercase letter\")\n        .regex(/[0-9]/, \"Password must contain at least one number\")\n        .regex(/[^A-Za-z0-9]/, \"Password must contain at least one special character\"),\n\n    confirmPassword: z.string()\n        .min(1, \"Please confirm your password\"),\n\n}).refine((data) => data.password === data.confirmPassword, {\n    message: \"Passwords do not match\",\n    path: [\"confirmPassword\"],\n});\n","export const AUTH_ROUTES = {\n  SIGNUP: \"/auth/signup\",\n  SIGNIN: \"/auth/signin\",\n  SIGNOUT: \"/auth/signout\",\n  GOOGLE: \"/auth/google\",\n  FORGOT_PASSWORD: \"/auth/forgot-password\",\n  RESET_PASSWORD: \"/auth/reset-password\",\n  REFRESH: \"/auth/refresh-token\",\n  ME: \"/auth/me\",\n  VERIFY: \"/auth/verify\",\n} as const;","// ==================== User Roles ====================\nexport const ROLES = {\n  STUDENT: \"student\",\n  TUTOR: \"tutor\",\n  ADMIN: \"admin\",\n} as const;\n\nexport type UserRole = (typeof ROLES)[keyof typeof ROLES];\n\n// ==================== User Status ====================\nexport const USER_STATUS = {\n  ACTIVE: \"active\",\n  INACTIVE: \"inactive\",\n  BANNED: \"banned\",\n} as const;\n\nexport type UserStatus = (typeof USER_STATUS)[keyof typeof USER_STATUS];\n\n","// ==================== Payment Controller ====================\nimport type { Response } from \"express\";\nimport Stripe from \"stripe\";\nimport { config } from \"../../config/index.js\";\nimport {\n  parsePagination,\n  sendCreated,\n  sendError,\n  sendNotFound,\n  sendPaginated,\n  sendSuccess,\n  toObjectId,\n} from \"../../shared/utils/index.js\";\nimport {\n  ApplicationModel,\n  TuitionModel,\n  PaymentModel,\n} from \"../../shared/models/index.js\";\nimport type { AuthRequest } from \"../auth/types.js\";\n\n// Initialize Stripe\nconst stripe = new Stripe(config.stripeSecretKey);\n\n// ==================== Payment Controller Class ====================\nexport class PaymentController {\n  // ==================== Create Checkout Session ====================\n  static async createCheckoutSession(\n    req: AuthRequest,\n    res: Response\n  ): Promise<void> {\n    const { applicationId } = req.body;\n    const { email } = req.user!;\n\n    const appObjectId = toObjectId(applicationId);\n    if (!appObjectId) {\n      sendError(res, \"Invalid application ID\");\n      return;\n    }\n\n    // Get application\n    const application = await ApplicationModel.findById(appObjectId);\n    if (!application) {\n      sendNotFound(res, \"Application not found\");\n      return;\n    }\n\n    // Get tuition\n    const tuition = await TuitionModel.findById(application.tuitionId);\n    if (!tuition) {\n      sendNotFound(res, \"Tuition not found\");\n      return;\n    }\n\n    // Verify ownership\n    if (tuition.student.email !== email) {\n      sendError(res, \"You can only pay for your own tuitions\", 403);\n      return;\n    }\n\n    // Verify application is approved\n    if (application.status !== \"approved\") {\n      sendError(res, \"Application must be approved before payment\", 400);\n      return;\n    }\n\n    // Create payment record\n    const payment = await PaymentModel.create({\n      applicationId: appObjectId,\n      tuitionId: application.tuitionId,\n      studentId: email,\n      tutorId: application.tutorId,\n      amount: application.expectedSalary,\n    });\n\n    // Create Stripe checkout session\n    const session = await stripe.checkout.sessions.create({\n      payment_method_types: [\"card\"],\n      line_items: [\n        {\n          price_data: {\n            currency: \"bdt\",\n            product_data: {\n              name: `Tuition: ${tuition.subject}`,\n              description: `Tutor: ${application.tutorName}`,\n            },\n            unit_amount: application.expectedSalary * 100, // Convert to paisa\n          },\n          quantity: 1,\n        },\n      ],\n      mode: \"payment\",\n      success_url: `${config.clientUrl}/payment/success?session_id={CHECKOUT_SESSION_ID}`,\n      cancel_url: `${config.clientUrl}/payment/cancel`,\n      metadata: {\n        paymentId: payment._id!.toString(),\n        applicationId: applicationId,\n      },\n    });\n\n    // Update payment with session ID\n    await PaymentModel.updateById(payment._id!, {\n      stripeSessionId: session.id,\n    });\n\n    sendCreated(\n      res,\n      { sessionId: session.id, url: session.url },\n      \"Checkout session created\"\n    );\n  }\n\n  // ==================== Verify Payment ====================\n  static async verifyPayment(req: AuthRequest, res: Response): Promise<void> {\n    const { sessionId } = req.params;\n\n    // Retrieve session from Stripe\n    const session = await stripe.checkout.sessions.retrieve(sessionId);\n\n    if (!session) {\n      sendNotFound(res, \"Session not found\");\n      return;\n    }\n\n    // Find payment by session ID\n    const payment = await PaymentModel.findBySessionId(sessionId);\n\n    if (!payment) {\n      sendNotFound(res, \"Payment not found\");\n      return;\n    }\n\n    // Update payment status if completed\n    if (session.payment_status === \"paid\" && payment.status !== \"completed\") {\n      await PaymentModel.markCompleted(payment._id!);\n\n      // Update application status to completed\n      await ApplicationModel.updateStatus(payment.applicationId, \"completed\");\n\n      // Update tuition status to completed\n      await TuitionModel.updateStatus(payment.tuitionId, \"completed\");\n    }\n\n    const updatedPayment = await PaymentModel.findById(payment._id!);\n\n    sendSuccess(res, updatedPayment, \"Payment verified successfully\");\n  }\n\n  // ==================== Get My Payments (Student) ====================\n  static async getMyPayments(req: AuthRequest, res: Response): Promise<void> {\n    const { skip, limit, page } = parsePagination(req.query);\n    const { email } = req.user!;\n\n    const { data: payments, total } = await PaymentModel.findByStudentId(email, {\n      skip,\n      limit,\n    });\n\n    sendPaginated(\n      res,\n      payments,\n      page,\n      limit,\n      total,\n      \"Payments fetched successfully\"\n    );\n  }\n\n  // ==================== Get Tutor Earnings ====================\n  static async getTutorEarnings(\n    req: AuthRequest,\n    res: Response\n  ): Promise<void> {\n    const { skip, limit, page } = parsePagination(req.query);\n    const { email } = req.user!;\n\n    const [{ data: payments, total }, totalEarnings] = await Promise.all([\n      PaymentModel.findByTutorId(email, { skip, limit }),\n      PaymentModel.getTutorEarnings(email),\n    ]);\n\n    sendSuccess(\n      res,\n      {\n        payments,\n        totalEarnings,\n        meta: { page, limit, total, totalPages: Math.ceil(total / limit) },\n      },\n      \"Earnings fetched successfully\"\n    );\n  }\n\n  // ==================== Get All Payments (Admin) ====================\n  static async getAllPayments(req: AuthRequest, res: Response): Promise<void> {\n    const { skip, limit, page } = parsePagination(req.query);\n\n    const { data: payments, total } = await PaymentModel.findAll(\n      {},\n      { skip, limit }\n    );\n\n    sendPaginated(\n      res,\n      payments,\n      page,\n      limit,\n      total,\n      \"All payments fetched successfully\"\n    );\n  }\n\n  // ==================== Get Payment by ID ====================\n  static async getById(req: AuthRequest, res: Response): Promise<void> {\n    const { id } = req.params;\n\n    const objectId = toObjectId(id);\n    if (!objectId) {\n      sendError(res, \"Invalid payment ID\");\n      return;\n    }\n\n    const payment = await PaymentModel.findById(objectId);\n\n    if (!payment) {\n      sendNotFound(res, \"Payment not found\");\n      return;\n    }\n\n    sendSuccess(res, payment, \"Payment fetched successfully\");\n  }\n}\n","import { getEnv } from \"@/shared/utils/getEnv.js\";\n\nexport const config = {\n    port: getEnv.number(\"PORT\", 5000),\n    nodeEnv: getEnv.string(\"NODE_ENV\", \"development\"),\n    clientUrl: getEnv.string(\"CLIENT_URL\", \"http://localhost:3000\"),\n    jwtSecret: getEnv.string(\n        \"JWT_SECRET\",\n        \"your-super-secret-jwt-key-change-in-production\"\n    ),\n    jwtExpiresIn: getEnv.string(\"JWT_EXPIRES_IN\", \"7d\"),\n    mongodbUri: getEnv.string(\"MONGODB_URI\", \"\"),\n    dbName: getEnv.string(\"DB_NAME\", \"etuitionbd\"),\n    stripeSecretKey: getEnv.string(\"STRIPE_SECRET_KEY\", \"\"),\n    platformFeePercentage: getEnv.number(\"PLATFORM_FEE_PERCENTAGE\", 10),\n};\n\n\nexport const logsConfig = {\n    enableLogs: {\n        server: config.nodeEnv === \"development\",\n        database: config.nodeEnv === \"development\",\n        requests: config.nodeEnv === \"development\",\n        errors: true, // Always log errors\n    },\n};","import admin, { ServiceAccount } from \"firebase-admin\";\n\nimport { getEnv } from \"@/shared/utils/getEnv.js\";\n\nexport class firebase {\n    static #app: admin.app.App | null = null;\n    static #initFailed: boolean = false;\n\n    static #getServiceAccount(): ServiceAccount {\n        const base64Json = getEnv.string('FIREBASE_ADMIN_SDK_JSON');\n\n        // Debug: log the length of base64 string\n        console.log(`[Firebase] Base64 string length: ${base64Json.length}`);\n\n        const adminSdkJson = Buffer.from(base64Json, 'base64').toString('utf-8');\n        const serviceAccount = JSON.parse(adminSdkJson) as ServiceAccount & { private_key?: string };\n\n        // Debug: log the first/last chars of private key\n        if (serviceAccount.private_key) {\n            const pk = serviceAccount.private_key;\n            console.log(`[Firebase] Private key starts with: ${pk.substring(0, 30)}...`);\n            console.log(`[Firebase] Private key ends with: ...${pk.substring(pk.length - 30)}`);\n            console.log(`[Firebase] Private key length: ${pk.length}`);\n\n            // Fix private key newlines - handle multiple escape scenarios\n            serviceAccount.private_key = pk\n                .replace(/\\\\\\\\n/g, '\\n')  // Double escaped \\\\n -> \\n\n                .replace(/\\\\n/g, '\\n');   // Single escaped \\n -> \\n\n        }\n\n        return serviceAccount;\n    }\n\n    static init() {\n        if (this.#app) return this.#app;\n        if (this.#initFailed) return null; // Don't retry if already failed\n\n        try {\n            const serviceAccount = this.#getServiceAccount();\n            this.#app = admin.initializeApp({ credential: admin.credential.cert(serviceAccount) })\n            this.logs.init.success()\n            return this.#app;\n        } catch (err) {\n            this.#initFailed = true;\n            this.logs.init.failed(err);\n            // Don't throw - allow app to start without Firebase for now\n            console.error('[Firebase] App will continue without Firebase authentication');\n            return null;\n        }\n    }\n\n    static verifyToken = async (idToken: string): Promise<admin.auth.DecodedIdToken> => {\n        try {\n            if (!this.#app) this.init();\n            const decodedIdToken = await admin.auth().verifyIdToken(idToken)\n            return decodedIdToken\n        } catch (error) {\n            console.error('Firebase token verification error:', error);\n            throw new Error(\"Invalid or expired Firebase token\");\n        }\n    }\n\n    static logs = {\n        init: {\n            success: () => console.log(\"âœ… Firebase Admin SDK initialized successfully\"),\n            failed: (err: unknown) => console.error(\"âŒ Firebase Admin SDK initialization error:\", err)\n        }\n    }\n}","// ==================== General Helpers ====================\nimport { ObjectId } from \"mongodb\";\n\n// ==================== ObjectId Helpers ====================\nexport const toObjectId = (id: string): ObjectId | null => {\n    try {\n        return new ObjectId(id);\n    } catch {\n        return null;\n    }\n};\n\nexport const isValidObjectId = (id: string): boolean => {\n    return ObjectId.isValid(id) && new ObjectId(id).toString() === id;\n};\n\n// ==================== Search Query Builder ====================\nexport const buildSearchQuery = (\n    search: string,\n    fields: string[]\n): Record<string, unknown> => {\n    const regex = { $regex: search, $options: \"i\" };\n    return {\n        $or: fields.map((field) => ({ [field]: regex })),\n    };\n};\n","// ==================== Pagination Helpers ====================\nimport type { PaginationQuery } from \"../types/index.js\";\n\n// ==================== Parse Pagination ====================\nexport const parsePagination = (\n    query: PaginationQuery\n): {\n    page: number;\n    limit: number;\n    skip: number;\n    sort: Record<string, 1 | -1>;\n} => {\n    const page = Math.max(1, parseInt(query.page || \"1\", 10));\n    const limit = Math.min(100, Math.max(1, parseInt(query.limit || \"10\", 10)));\n    const skip = (page - 1) * limit;\n\n    const sortField = query.sort || \"createdAt\";\n    const sortOrder = query.order === \"asc\" ? 1 : -1;\n    const sort: Record<string, 1 | -1> = { [sortField]: sortOrder };\n\n    return { page, limit, skip, sort };\n};\n","// ==================== Response Helpers ====================\nimport type { Response } from \"express\";\nimport { HTTP_STATUS } from \"../constants/index.js\";\n\n// ==================== Success Response ====================\nexport const sendSuccess = <T>(\n    res: Response,\n    data: T,\n    message: string = \"Success\"\n): void => {\n    res.status(HTTP_STATUS.OK).json({\n        success: true,\n        message,\n        data,\n    });\n};\n\n// ==================== Created Response ====================\nexport const sendCreated = <T>(\n    res: Response,\n    data: T,\n    message: string = \"Created successfully\"\n): void => {\n    res.status(HTTP_STATUS.CREATED).json({\n        success: true,\n        message,\n        data,\n    });\n};\n\n// ==================== Paginated Response ====================\nexport const sendPaginated = <T>(\n    res: Response,\n    data: T[],\n    page: number,\n    limit: number,\n    total: number,\n    message: string = \"Data fetched successfully\"\n): void => {\n    res.status(HTTP_STATUS.OK).json({\n        success: true,\n        message,\n        data,\n        meta: {\n            page,\n            limit,\n            total,\n            totalPages: Math.ceil(total / limit),\n        },\n    });\n};\n\n// ==================== Error Response ====================\nexport const sendError = (\n    res: Response,\n    message: string,\n    statusCode: number = HTTP_STATUS.BAD_REQUEST\n): void => {\n    res.status(statusCode).json({\n        success: false,\n        message,\n    });\n};\n\n// ==================== Not Found Response ====================\nexport const sendNotFound = (\n    res: Response,\n    message: string = \"Resource not found\"\n): void => {\n    res.status(HTTP_STATUS.NOT_FOUND).json({\n        success: false,\n        message,\n    });\n};\n","// ==================== User Model ====================\nimport bcrypt from \"bcrypt\";\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport { PUBLIC_USER_PROJECTION } from \"./constants.js\";\nimport type { IUser, UserRole, UserStatus } from \"./types.js\";\nimport { db } from \"@/config/db.js\";\nimport { SignUpCreds } from \"@/shared-types/auth/index.js\";\n\nconst DEFAULT_USER_ROLE: UserRole = \"student\";\nconst DEFAULT_USER_STATUS: UserStatus = \"active\";\n\n// ==================== User Model Class ====================\nexport class UserModel {\n    private static get collection() {\n        return db.getDB().collection<IUser>('users');\n    }\n\n    // Create new user\n    static async create(data: IUser): Promise<WithId<IUser>> {\n        const newUser: IUser = {\n            name: data.name || '',\n            email: data.email,\n            phone: data.phone || null,\n            role: data.role || DEFAULT_USER_ROLE,\n            password: data.password || '',\n            photoUrl: data.photoUrl || null,\n            status: data.status || DEFAULT_USER_STATUS,\n            qualifications: data.qualifications || \"\",\n            experience: data.experience || \"\",\n            subjects: data.subjects || [],\n            bio: data.bio || \"\",\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n\n        const result = await this.collection.insertOne(newUser);\n        return { ...newUser, _id: result.insertedId };\n    }\n\n    // Find by ID\n    static async findById(id: string | ObjectId): Promise<WithId<IUser> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        return this.collection.findOne({ _id: objectId });\n    }\n\n    // Find by email\n    static async findByEmail(email: string): Promise<WithId<IUser> | null> {\n        return this.collection.findOne({ email });\n    }\n\n    // Find all with pagination\n    static async findAll(\n        filter: Filter<IUser> = {},\n        options: {\n            skip?: number;\n            limit?: number;\n            sort?: Record<string, 1 | -1>;\n        } = {}\n    ): Promise<{ data: WithId<IUser>[]; total: number }> {\n        const { skip = 0, limit = 10, sort = { createdAt: -1 } } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection\n                .find(filter, { projection: PUBLIC_USER_PROJECTION })\n                .sort(sort)\n                .skip(skip)\n                .limit(limit)\n                .toArray(),\n            this.collection.countDocuments(filter),\n        ]);\n\n        return { data, total };\n    }\n\n    // Find tutors\n    static async findTutors(\n        filter: Filter<IUser> = {},\n        options: { skip?: number; limit?: number } = {}\n    ): Promise<{ data: WithId<IUser>[]; total: number }> {\n        const tutorFilter = { ...filter, role: \"tutor\" as UserRole };\n        return this.findAll(tutorFilter, options);\n    }\n\n    // Update by Email\n    static async updateByEmail(email: string, data: Partial<IUser>): Promise<WithId<IUser> | null> {\n        const updateData: UpdateFilter<IUser> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate({ email }, updateData, { returnDocument: \"after\" });\n        return result;\n    }\n\n    // Update by ID\n    static async updateById(id: string | ObjectId, data: Partial<IUser>): Promise<WithId<IUser> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const updateData: UpdateFilter<IUser> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate({ _id: objectId }, updateData, { returnDocument: \"after\" });\n        return result;\n    }\n\n    // Update role\n    static async updateRole(email: string, role: UserRole): Promise<WithId<IUser> | null> {\n        return this.updateByEmail(email, { role });\n    }\n\n    // Ban/Unban user\n    static async updateStatus(email: string, status: UserStatus): Promise<WithId<IUser> | null> {\n        return this.updateByEmail(email, { status });\n    }\n\n    // Delete by Email\n    static async deleteByEmail(email: string): Promise<boolean> {\n        const result = await this.collection.deleteOne({ email });\n        return result.deletedCount > 0;\n    }\n\n    // Check if user exists\n    static async exists(email: string): Promise<boolean> {\n        const count = await this.collection.countDocuments({ email });\n        return count > 0;\n    }\n\n    // Count users by role\n    static async countByRole(role: UserRole): Promise<number> {\n        return this.collection.countDocuments({ role });\n    }\n\n    // Users grouped by role with counts\n    static async usersByRole(): Promise<Array<{ role: UserRole; count: number }>> {\n        return this.collection\n            .aggregate<{ role: UserRole; count: number }>([\n                { $group: { _id: \"$role\", count: { $sum: 1 } } },\n                { $project: { role: \"$_id\", count: 1, _id: 0 } }\n            ])\n            .toArray();\n    }\n\n    // Get distinct values for tutor fields (API v1 compatible)\n    static async getDistinctValues(field: keyof IUser, filter: Filter<IUser> = {}): Promise<string[]> {\n        const results = await this.collection\n            .aggregate([\n                { $match: filter },\n                { $unwind: `$${String(field)}` },\n                { $group: { _id: `$${String(field)}` } },\n                { $sort: { _id: 1 } }\n            ])\n            .toArray();\n\n        return results\n            .map(doc => doc._id)\n            .filter(value => value != null && value !== '')\n            .map(v => String(v));\n    }\n}\n","\n// ==================== User Projections ====================\nexport const PUBLIC_USER_PROJECTION = {\n    email: 1,\n    name: 1,\n    phone: 1,\n    role: 1,\n    photoUrl: 1,\n    qualifications: 1,\n    experience: 1,\n    subjects: 1,\n    bio: 1,\n    status: 1,\n    createdAt: 1,\n};\n\nexport const TUTOR_LIST_PROJECTION = {\n    name: 1,\n    email: 1,\n    photoUrl: 1,\n    qualifications: 1,\n    experience: 1,\n    subjects: 1,\n    bio: 1,\n    createdAt: 1,\n};\n\nexport const TUTOR_DETAIL_PROJECTION = {\n    name: 1,\n    email: 1,\n    phone: 1,\n    photoUrl: 1,\n    qualifications: 1,\n    experience: 1,\n    subjects: 1,\n    bio: 1,\n    createdAt: 1,\n};\n\n// ==================== Tuition Projections ====================\nexport const TUITION_LIST_PROJECTION = {\n    _id: 1,\n    studentName: 1,\n    subject: 1,\n    class: 1,\n    location: 1,\n    budget: 1,\n    schedule: 1,\n    status: 1,\n    applicationsCount: 1,\n    createdAt: 1,\n};\n\nexport const TUITION_DETAIL_PROJECTION = {\n    _id: 1,\n    studentId: 1,\n    studentEmail: 1,\n    studentName: 1,\n    subject: 1,\n    class: 1,\n    location: 1,\n    budget: 1,\n    schedule: 1,\n    description: 1,\n    requirements: 1,\n    status: 1,\n    applicationsCount: 1,\n    createdAt: 1,\n    updatedAt: 1,\n};\n\n// ==================== Application Projections ====================\nexport const APPLICATION_LIST_PROJECTION = {\n    _id: 1,\n    tuitionId: 1,\n    tutorId: 1,\n    tutorName: 1,\n    tutorEmail: 1,\n    tutorPhotoUrl: 1,\n    qualifications: 1,\n    experience: 1,\n    expectedSalary: 1,\n    status: 1,\n    createdAt: 1,\n};\n\nexport const APPLICATION_DETAIL_PROJECTION = {\n    _id: 1,\n    tuitionId: 1,\n    tutorId: 1,\n    tutorEmail: 1,\n    tutorName: 1,\n    tutorPhotoUrl: 1,\n    qualifications: 1,\n    experience: 1,\n    expectedSalary: 1,\n    coverLetter: 1,\n    status: 1,\n    createdAt: 1,\n    updatedAt: 1,\n};\n\n// ==================== Payment Projections ====================\nexport const PAYMENT_LIST_PROJECTION = {\n    _id: 1,\n    applicationId: 1,\n    tuitionId: 1,\n    studentId: 1,\n    tutorId: 1,\n    amount: 1,\n    platformFee: 1,\n    tutorEarnings: 1,\n    status: 1,\n    paidAt: 1,\n    createdAt: 1,\n};\n","// ==================== Tuition Model ====================\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport type { ITuition, TuitionStatus } from \"./types.js\";\nimport { db } from \"@/config/db.js\";\nimport { TUITION_LIST_PROJECTION } from \"./constants.js\";\n\nconst DEFAULT_TUITION_STATUS: TuitionStatus = \"pending\";\n\n// ==================== Tuition Model Class ====================\nexport class TuitionModel {\n    private static get collection() {\n        return db.getDB().collection<ITuition>('tuitions');\n    }\n\n    // Create new tuition\n    static async create(data: Omit<ITuition, 'status' | 'applicationsCount' | 'createdAt' | 'updatedAt'> & Partial<Pick<ITuition, 'status' | 'applicationsCount'>>): Promise<WithId<ITuition>> {\n        const newTuition: ITuition = {\n            student: data.student,\n            subject: data.subject,\n            class: data.class,\n            location: data.location,\n            budget: data.budget,\n            schedule: data.schedule,\n            description: data.description || \"\",\n            requirements: data.requirements || \"\",\n            status: data.status || DEFAULT_TUITION_STATUS,\n            applicationsCount: data.applicationsCount || 0,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n\n        const result = await this.collection.insertOne(newTuition);\n        return { ...newTuition, _id: result.insertedId };\n    }\n\n    // Find by ID\n    static async findById(id: string | ObjectId): Promise<WithId<ITuition> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        return this.collection.findOne({ _id: objectId });\n    }\n\n    // Find all with pagination and filters\n    static async findAll(\n        filter: Filter<ITuition> = {},\n        options: {\n            skip?: number;\n            limit?: number;\n            sort?: Record<string, 1 | -1>;\n        } = {}\n    ): Promise<{ data: WithId<ITuition>[]; total: number }> {\n        const { skip = 0, limit = 10, sort = { createdAt: -1 } } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection\n                .find(filter, { projection: TUITION_LIST_PROJECTION })\n                .sort(sort)\n                .skip(skip)\n                .limit(limit)\n                .toArray(),\n            this.collection.countDocuments(filter),\n        ]);\n\n        return { data, total };\n    }\n\n    // Find by student ID\n    static async findByStudentId(\n        studentId: string,\n        options: { skip?: number; limit?: number } = {}\n    ): Promise<{ data: WithId<ITuition>[]; total: number }> {\n        return this.findAll({ studentId }, options);\n    }\n\n    // Update by ID\n    static async updateById(\n        id: string | ObjectId,\n        data: Partial<ITuition>\n    ): Promise<WithId<ITuition> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const updateData: UpdateFilter<ITuition> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate(\n            { _id: objectId },\n            updateData,\n            { returnDocument: \"after\" }\n        );\n\n        return result;\n    }\n\n    // Update status\n    static async updateStatus(\n        id: string | ObjectId,\n        status: TuitionStatus\n    ): Promise<WithId<ITuition> | null> {\n        return this.updateById(id, { status });\n    }\n\n    // Increment applications count\n    static async incrementApplicationsCount(\n        id: string | ObjectId\n    ): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const result = await this.collection.updateOne(\n            { _id: objectId },\n            { $inc: { applicationsCount: 1 }, $set: { updatedAt: new Date() } }\n        );\n        return result.modifiedCount > 0;\n    }\n\n    // Decrement applications count\n    static async decrementApplicationsCount(\n        id: string | ObjectId\n    ): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const result = await this.collection.updateOne(\n            { _id: objectId },\n            { $inc: { applicationsCount: -1 }, $set: { updatedAt: new Date() } }\n        );\n        return result.modifiedCount > 0;\n    }\n\n    // Delete by ID\n    static async deleteById(id: string | ObjectId): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const result = await this.collection.deleteOne({ _id: objectId });\n        return result.deletedCount > 0;\n    }\n\n    // Check ownership\n    static async isOwner(\n        id: string | ObjectId,\n        studentId: string\n    ): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const count = await this.collection.countDocuments({\n            _id: objectId,\n            studentId,\n        });\n        return count > 0;\n    }\n\n    // Search tuitions\n    static async search(\n        query: string,\n        options: { skip?: number; limit?: number } = {}\n    ): Promise<{ data: WithId<ITuition>[]; total: number }> {\n        const searchFilter: Filter<ITuition> = {\n            $or: [\n                { subject: { $regex: query, $options: \"i\" } },\n                { location: { $regex: query, $options: \"i\" } },\n                { class: { $regex: query, $options: \"i\" } },\n            ],\n        };\n        return this.findAll(searchFilter, options);\n    }\n\n    // Get tuitions count grouped by status\n    static async countByStatus(): Promise<{ status: TuitionStatus; count: number }[]> {\n        return this.collection\n            .aggregate([\n                { $group: { _id: \"$status\", count: { $sum: 1 } } },\n                { $project: { status: \"$_id\", count: 1, _id: 0 } }\n            ])\n            .toArray() as Promise<{ status: TuitionStatus; count: number }[]>;\n    }\n\n    // Get distinct values for a field with filters using aggregation (API v1 compatible)\n    static async getDistinctValues(field: keyof ITuition, filter: Filter<ITuition> = {}): Promise<string[]> {\n        const results = await this.collection\n            .aggregate([\n                { $match: filter },\n                { $group: { _id: `$${String(field)}` } },\n                { $sort: { _id: 1 } }\n            ])\n            .toArray();\n\n        return results\n            .map(doc => doc._id)\n            .filter(value => value != null && value !== '')\n            .map(v => String(v));\n    }\n}\n","// ==================== Application Model ====================\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport { APPLICATION_LIST_PROJECTION } from \"./constants.js\";\nimport type { ApplicationStatus, IApplication } from \"./types.js\";\nimport { db } from \"@/config/db.js\";\n\nconst DEFAULT_APPLICATION_STATUS: ApplicationStatus = \"pending\";\n\n// ==================== Application Model Class ====================\nexport class ApplicationModel {\n    private static get collection() {\n        return db.getDB().collection<IApplication>('applications');\n    }\n\n    // Create new application\n    static async create(data: Omit<IApplication, 'status' | 'createdAt' | 'updatedAt'> & Partial<Pick<IApplication, 'status'>>): Promise<WithId<IApplication>> {\n        const newApplication: IApplication = {\n            tuitionId: data.tuitionId,\n            tutorId: data.tutorId,\n            tutorEmail: data.tutorEmail,\n            tutorName: data.tutorName,\n            tutorPhotoUrl: data.tutorPhotoUrl || null,\n            qualifications: data.qualifications,\n            experience: data.experience,\n            expectedSalary: data.expectedSalary,\n            coverLetter: data.coverLetter || \"\",\n            status: data.status || DEFAULT_APPLICATION_STATUS,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n\n        const result = await this.collection.insertOne(newApplication);\n        return { ...newApplication, _id: result.insertedId };\n    }\n\n    // Find by ID\n    static async findById(id: string | ObjectId): Promise<WithId<IApplication> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        return this.collection.findOne({ _id: objectId });\n    }\n\n    // Find all with pagination\n    static async findAll(filter: Filter<IApplication> = {}, options: { skip?: number; limit?: number; sort?: Record<string, 1 | -1>; } = {}): Promise<{ data: WithId<IApplication>[]; total: number }> {\n        const { skip = 0, limit = 10, sort = { createdAt: -1 } } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection.find(filter, { projection: APPLICATION_LIST_PROJECTION }).sort(sort).skip(skip).limit(limit).toArray(),\n            this.collection.countDocuments(filter),\n        ]);\n\n        return { data, total };\n    }\n\n    // Find by tuition ID\n    static async findByTuitionId(tuitionId: string | ObjectId, options: { skip?: number; limit?: number } = {}): Promise<{ data: WithId<IApplication>[]; total: number }> {\n        const objectId = typeof tuitionId === \"string\" ? new ObjectId(tuitionId) : tuitionId;\n        return this.findAll({ tuitionId: objectId }, options);\n    }\n\n    // Find by tutor ID\n    static async findByTutorId(tutorId: string, options: { skip?: number; limit?: number } = {}): Promise<{ data: WithId<IApplication>[]; total: number }> {\n        return this.findAll({ tutorId }, options);\n    }\n\n    // Update by ID\n    static async updateById(id: string | ObjectId, data: Partial<IApplication>): Promise<WithId<IApplication> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const updateData: UpdateFilter<IApplication> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate({ _id: objectId }, updateData, { returnDocument: \"after\" });\n        return result;\n    }\n\n    // Update status\n    static async updateStatus(id: string | ObjectId, status: ApplicationStatus): Promise<WithId<IApplication> | null> {\n        return this.updateById(id, { status });\n    }\n\n    // Delete by ID\n    static async deleteById(id: string | ObjectId): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const result = await this.collection.deleteOne({ _id: objectId });\n        return result.deletedCount > 0;\n    }\n\n    // Delete by tuition ID (when tuition is deleted)\n    static async deleteByTuitionId(tuitionId: string | ObjectId): Promise<number> {\n        const objectId = typeof tuitionId === \"string\" ? new ObjectId(tuitionId) : tuitionId;\n        const result = await this.collection.deleteMany({ tuitionId: objectId });\n        return result.deletedCount;\n    }\n\n    // Check if tutor already applied\n    static async hasApplied(tuitionId: string | ObjectId, tutorId: string): Promise<boolean> {\n        const objectId = typeof tuitionId === \"string\" ? new ObjectId(tuitionId) : tuitionId;\n        const count = await this.collection.countDocuments({ tuitionId: objectId, tutorId, });\n        return count > 0;\n    }\n\n    // Check ownership\n    static async isOwner(id: string | ObjectId, tutorId: string): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const count = await this.collection.countDocuments({ _id: objectId, tutorId, });\n        return count > 0;\n    }\n\n    // Get applications count grouped by status\n    static async countByStatus(): Promise<{ status: ApplicationStatus; count: number }[]> {\n        const result = await this.collection\n            .aggregate([\n                { $group: { _id: \"$status\", count: { $sum: 1 } } }\n            ])\n            .toArray();\n\n        return result.map(item => ({ status: item._id, count: item.count }));\n    }\n}","// ==================== Payment Model ====================\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport { PAYMENT_LIST_PROJECTION } from \"./constants.js\";\nimport type { IPayment, PaymentStatus } from \"./types.js\";\nimport { db } from \"@/config/db.js\";\n\nconst DEFAULT_PAYMENT_STATUS: PaymentStatus = \"pending\";\n\n// ==================== Payment Model Class ====================\nexport class PaymentModel {\n    private static get collection() {\n        return db.getDB().collection<IPayment>('payments');\n    }\n\n\n    // Calculate platform fee and tutor earnings\n    static calculateAmounts(amount: number): { platformFee: number; tutorEarnings: number; } {\n        const platformFee = Math.round((amount * 10) / 100);\n        const tutorEarnings = amount - platformFee;\n        return { platformFee, tutorEarnings };\n    }\n\n    // Create new payment\n    static async create(data: Omit<IPayment, 'platformFee' | 'tutorEarnings' | 'status' | 'createdAt' | 'updatedAt'> & Partial<Pick<IPayment, 'status' | 'stripePaymentIntentId' | 'stripeSessionId' | 'paidAt'>>): Promise<WithId<IPayment>> {\n        const { platformFee, tutorEarnings } = this.calculateAmounts(data.amount);\n\n        const newPayment: IPayment = {\n            applicationId: data.applicationId,\n            tuitionId: data.tuitionId,\n            studentId: data.studentId,\n            tutorId: data.tutorId,\n            amount: data.amount,\n            platformFee,\n            tutorEarnings,\n            stripePaymentIntentId: data.stripePaymentIntentId || undefined,\n            stripeSessionId: data.stripeSessionId || undefined,\n            status: data.status || DEFAULT_PAYMENT_STATUS,\n            paidAt: data.paidAt || undefined,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n\n        const result = await this.collection.insertOne(newPayment);\n        return { ...newPayment, _id: result.insertedId };\n    }\n\n    // Find by ID\n    static async findById(id: string | ObjectId): Promise<WithId<IPayment> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        return this.collection.findOne({ _id: objectId });\n    }\n\n    // Find by Stripe session ID\n    static async findBySessionId(sessionId: string): Promise<WithId<IPayment> | null> {\n        return this.collection.findOne({ stripeSessionId: sessionId });\n    }\n\n    // Find all with pagination\n    static async findAll(filter: Filter<IPayment> = {}, options: { skip?: number; limit?: number; sort?: Record<string, 1 | -1>; } = {}): Promise<{ data: WithId<IPayment>[]; total: number }> {\n        const { skip = 0, limit = 10, sort = { createdAt: -1 } } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection.find(filter, { projection: PAYMENT_LIST_PROJECTION }).sort(sort).skip(skip).limit(limit).toArray(),\n            this.collection.countDocuments(filter),\n        ]);\n\n        return { data, total };\n    }\n\n    // Find by student ID\n    static async findByStudentId(studentId: string, options: { skip?: number; limit?: number } = {}): Promise<{ data: WithId<IPayment>[]; total: number }> {\n        return this.findAll({ studentId }, options);\n    }\n\n    // Find by tutor ID\n    static async findByTutorId(tutorId: string, options: { skip?: number; limit?: number } = {}): Promise<{ data: WithId<IPayment>[]; total: number }> {\n        return this.findAll({ tutorId }, options);\n    }\n\n    // Update by ID\n    static async updateById(id: string | ObjectId, data: Partial<IPayment>): Promise<WithId<IPayment> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const updateData: UpdateFilter<IPayment> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate({ _id: objectId }, updateData, { returnDocument: \"after\" });\n        return result;\n    }\n\n    // Update status\n    static async updateStatus(id: string | ObjectId, status: PaymentStatus, paidAt?: Date): Promise<WithId<IPayment> | null> {\n        const updateData: Partial<IPayment> = { status };\n        if (paidAt) updateData.paidAt = paidAt;\n        return this.updateById(id, updateData);\n    }\n\n    // Mark as completed\n    static async markCompleted(id: string | ObjectId): Promise<WithId<IPayment> | null> {\n        return this.updateStatus(id, \"completed\", new Date());\n    }\n\n    // Get total earnings for tutor\n    static async getTutorEarnings(tutorId: string): Promise<number> {\n        const result = await this.collection\n            .aggregate<{ total: number }>([\n                { $match: { tutorId, status: \"completed\" } },\n                { $group: { _id: null, total: { $sum: \"$tutorEarnings\" } } },\n            ]).toArray();\n\n        return result[0]?.total || 0;\n    }\n\n    // Get platform total earnings\n    static async getPlatformEarnings(): Promise<number> {\n        const result = await this.collection\n            .aggregate<{ total: number }>([\n                { $match: { status: \"completed\" } },\n                { $group: { _id: null, total: { $sum: \"$platformFee\" } } },\n            ])\n            .toArray();\n\n        return result[0]?.total || 0;\n    }\n\n    static async revenue(\n        startDate = new Date(new Date().getFullYear(), new Date().getMonth() - 1, 1),\n        endDate = new Date(new Date().getFullYear(), new Date().getMonth(), 1)\n    ): Promise<number> {\n\n        const result = await this.collection\n            .aggregate<{ total: number }>([\n                {\n                    $match: {\n                        status: \"completed\",\n                        paidAt: { $gte: startDate, $lt: endDate },\n                    },\n                },\n                {\n                    $group: {\n                        _id: null,\n                        total: { $sum: \"$platformFee\" },\n                    },\n                },\n            ])\n            .toArray();\n\n        return result[0]?.total || 0;\n    }\n}\n","// ==================== Review Model ====================\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport type { IReview } from \"@/shared-types/reviews/index.js\";\nimport { db } from \"@/config/db.js\";\n\n// ==================== Review Model Class ====================\nexport class ReviewModel {\n    private static get collection() {\n        return db.getDB().collection<IReview>('reviews');\n    }\n\n    // Create new review\n    static async create(data: IReview): Promise<WithId<IReview>> {\n        const newReview: IReview = {\n            tutorId: data.tutorId,\n            studentId: data.studentId,\n            studentName: data.studentName,\n            studentPhoto: data.studentPhoto || undefined,\n            rating: data.rating,\n            comment: data.comment,\n            createdAt: new Date(),\n            updatedAt: new Date(),\n        };\n\n        const result = await this.collection.insertOne(newReview);\n        return { ...newReview, _id: result.insertedId };\n    }\n\n    // Find by ID\n    static async findById(id: string | ObjectId): Promise<WithId<IReview> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        return this.collection.findOne({ _id: objectId } as any);\n    }\n\n    // Find reviews by tutor ID\n    static async findByTutor(\n        tutorId: string,\n        options: { skip?: number; limit?: number } = {}\n    ): Promise<{ data: WithId<IReview>[]; total: number }> {\n        const { skip = 0, limit = 10 } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection\n                .find({ tutorId })\n                .sort({ createdAt: -1 })\n                .skip(skip)\n                .limit(limit)\n                .toArray(),\n            this.collection.countDocuments({ tutorId }),\n        ]);\n\n        return { data, total };\n    }\n\n    // Find review by tutor and student\n    static async findByTutorAndStudent(\n        tutorId: string,\n        studentId: string\n    ): Promise<WithId<IReview> | null> {\n        return this.collection.findOne({ tutorId, studentId });\n    }\n\n    // Find all reviews\n    static async findAll(\n        filter: Filter<IReview> = {},\n        options: { skip?: number; limit?: number } = {}\n    ): Promise<{ data: WithId<IReview>[]; total: number }> {\n        const { skip = 0, limit = 10 } = options;\n\n        const [data, total] = await Promise.all([\n            this.collection\n                .find(filter)\n                .sort({ createdAt: -1 })\n                .skip(skip)\n                .limit(limit)\n                .toArray(),\n            this.collection.countDocuments(filter),\n        ]);\n\n        return { data, total };\n    }\n\n    // Update review by ID\n    static async updateById(\n        id: string | ObjectId,\n        data: Partial<IReview>\n    ): Promise<WithId<IReview> | null> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const updateData: UpdateFilter<IReview> = {\n            $set: { ...data, updatedAt: new Date() },\n        };\n\n        const result = await this.collection.findOneAndUpdate(\n            { _id: objectId } as any,\n            updateData,\n            { returnDocument: \"after\" }\n        );\n\n        return result;\n    }\n\n    // Delete review by ID\n    static async deleteById(id: string | ObjectId): Promise<boolean> {\n        const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n        const result = await this.collection.deleteOne({ _id: objectId } as any);\n        return result.deletedCount > 0;\n    }\n\n    // Delete reviews by tutor (for cascading delete)\n    static async deleteByTutor(tutorId: string): Promise<number> {\n        const result = await this.collection.deleteMany({ tutorId });\n        return result.deletedCount;\n    }\n\n    // Get average rating for tutor\n    static async getAverageRating(tutorId: string): Promise<number> {\n        const result = await this.collection\n            .aggregate([\n                { $match: { tutorId } },\n                { $group: { _id: null, avgRating: { $avg: \"$rating\" } } },\n            ])\n            .toArray();\n\n        return result.length > 0 ? Math.round((result[0].avgRating + Number.EPSILON) * 10) / 10 : 0;\n    }\n\n    // Get review count for tutor\n    static async getReviewCount(tutorId: string): Promise<number> {\n        return this.collection.countDocuments({ tutorId });\n    }\n}\n","// ==================== Payment Model ====================\nimport { Filter, ObjectId, UpdateFilter, WithId } from \"mongodb\";\nimport { config, db } from \"../../config/index.js\";\nimport {\n  DEFAULT_PAYMENT_STATUS,\n  PAYMENT_COLLECTION,\n  type PaymentStatus,\n} from \"@/shared-types/payments/index.js\";\nimport { PAYMENT_LIST_PROJECTION } from \"./constants.js\";\nimport type { IPayment } from \"./types.js\";\n\n// ==================== Payment Model Class ====================\nexport class PaymentModel {\n  private static get collection() {\n    return db.getDB().collection<IPayment>(PAYMENT_COLLECTION);\n  }\n\n  // Calculate platform fee and tutor earnings\n  static calculateAmounts(amount: number): {\n    platformFee: number;\n    tutorEarnings: number;\n  } {\n    const platformFee = Math.round(\n      (amount * config.platformFeePercentage) / 100\n    );\n    const tutorEarnings = amount - platformFee;\n    return { platformFee, tutorEarnings };\n  }\n\n  // Create new payment\n  static async create(\n    data: Partial<IPayment> & {\n      applicationId: ObjectId;\n      tuitionId: ObjectId;\n      studentId: string;\n      tutorId: string;\n      amount: number;\n    }\n  ): Promise<WithId<IPayment>> {\n    const { platformFee, tutorEarnings } = this.calculateAmounts(data.amount);\n\n    const newPayment: IPayment = {\n      applicationId: data.applicationId,\n      tuitionId: data.tuitionId,\n      studentId: data.studentId,\n      tutorId: data.tutorId,\n      amount: data.amount,\n      platformFee,\n      tutorEarnings,\n      stripePaymentIntentId: data.stripePaymentIntentId || undefined,\n      stripeSessionId: data.stripeSessionId || undefined,\n      status: data.status || (DEFAULT_PAYMENT_STATUS as PaymentStatus),\n      paidAt: data.paidAt || undefined,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n    };\n\n    const result = await this.collection.insertOne(newPayment);\n    return { ...newPayment, _id: result.insertedId };\n  }\n\n  // Find by ID\n  static async findById(\n    id: string | ObjectId\n  ): Promise<WithId<IPayment> | null> {\n    const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n    return this.collection.findOne({ _id: objectId });\n  }\n\n  // Find by Stripe session ID\n  static async findBySessionId(\n    sessionId: string\n  ): Promise<WithId<IPayment> | null> {\n    return this.collection.findOne({ stripeSessionId: sessionId });\n  }\n\n  // Find all with pagination\n  static async findAll(\n    filter: Filter<IPayment> = {},\n    options: {\n      skip?: number;\n      limit?: number;\n      sort?: Record<string, 1 | -1>;\n    } = {}\n  ): Promise<{ data: WithId<IPayment>[]; total: number }> {\n    const { skip = 0, limit = 10, sort = { createdAt: -1 } } = options;\n\n    const [data, total] = await Promise.all([\n      this.collection\n        .find(filter, { projection: PAYMENT_LIST_PROJECTION })\n        .sort(sort)\n        .skip(skip)\n        .limit(limit)\n        .toArray(),\n      this.collection.countDocuments(filter),\n    ]);\n\n    return { data, total };\n  }\n\n  // Find by student ID\n  static async findByStudentId(\n    studentId: string,\n    options: { skip?: number; limit?: number } = {}\n  ): Promise<{ data: WithId<IPayment>[]; total: number }> {\n    return this.findAll({ studentId }, options);\n  }\n\n  // Find by tutor ID\n  static async findByTutorId(\n    tutorId: string,\n    options: { skip?: number; limit?: number } = {}\n  ): Promise<{ data: WithId<IPayment>[]; total: number }> {\n    return this.findAll({ tutorId }, options);\n  }\n\n  // Update by ID\n  static async updateById(\n    id: string | ObjectId,\n    data: Partial<IPayment>\n  ): Promise<WithId<IPayment> | null> {\n    const objectId = typeof id === \"string\" ? new ObjectId(id) : id;\n    const updateData: UpdateFilter<IPayment> = {\n      $set: { ...data, updatedAt: new Date() },\n    };\n\n    const result = await this.collection.findOneAndUpdate(\n      { _id: objectId },\n      updateData,\n      { returnDocument: \"after\" }\n    );\n\n    return result;\n  }\n\n  // Update status\n  static async updateStatus(\n    id: string | ObjectId,\n    status: PaymentStatus,\n    paidAt?: Date\n  ): Promise<WithId<IPayment> | null> {\n    const updateData: Partial<IPayment> = { status };\n    if (paidAt) updateData.paidAt = paidAt;\n    return this.updateById(id, updateData);\n  }\n\n  // Mark as completed\n  static async markCompleted(\n    id: string | ObjectId\n  ): Promise<WithId<IPayment> | null> {\n    return this.updateStatus(id, \"completed\", new Date());\n  }\n\n  // Get total earnings for tutor\n  static async getTutorEarnings(tutorId: string): Promise<number> {\n    const result = await this.collection\n      .aggregate<{ total: number }>([\n        { $match: { tutorId, status: \"completed\" } },\n        { $group: { _id: null, total: { $sum: \"$tutorEarnings\" } } },\n      ])\n      .toArray();\n\n    return result[0]?.total || 0;\n  }\n\n  // Get platform total earnings\n  static async getPlatformEarnings(): Promise<number> {\n    const result = await this.collection\n      .aggregate<{ total: number }>([\n        { $match: { status: \"completed\" } },\n        { $group: { _id: null, total: { $sum: \"$platformFee\" } } },\n      ])\n      .toArray();\n\n    return result[0]?.total || 0;\n  }\n}\n","export const PAYMENT_ROUTES = {\n  ALL: \"/payments\",\n  MY: \"/payments/my\",\n  BY_ID: (id: string) => `/payments/${id}`,\n  CREATE_INTENT: \"/payments/create-intent\",\n  CREATE_CHECKOUT: \"/payments/create-checkout-session\",\n  CONFIRM: \"/payments/confirm\",\n  WEBHOOK: \"/payments/webhook\",\n  SUCCESS: (sessionId: string) => `/payments/success/${sessionId}`,\n  EARNINGS: \"/payments/earnings\",\n} as const;\n\n// ==================== Payment Constants ====================\nexport const PAYMENT_COLLECTION = \"payments\";\nexport const DEFAULT_PAYMENT_STATUS = \"pending\" as const;\n\n// ==================== Payment Types ====================\nexport type PaymentStatus = \"pending\" | \"completed\" | \"failed\" | \"refunded\";\n","// ==================== Payment Routes ====================\nimport { Router } from \"express\";\nimport { PAYMENT_ROUTES } from \"@/shared-types/payments/index.js\";\nimport {\n  adminMiddleware,\n  asyncHandler,\n  authMiddleware,\n  studentMiddleware,\n  tutorMiddleware,\n} from \"../../shared/middleware/index.js\";\nimport { PaymentController } from \"./controller.js\";\n\nconst router: Router = Router();\n\n// ==================== Student Routes ====================\nrouter.post(\n  PAYMENT_ROUTES.CREATE_CHECKOUT,\n  authMiddleware,\n  studentMiddleware,\n  asyncHandler(PaymentController.createCheckoutSession)\n);\n\nrouter.get(\n  PAYMENT_ROUTES.MY,\n  authMiddleware,\n  studentMiddleware,\n  asyncHandler(PaymentController.getMyPayments)\n);\n\nrouter.get(\n  PAYMENT_ROUTES.SUCCESS(\":sessionId\"),\n  authMiddleware,\n  asyncHandler(PaymentController.verifyPayment)\n);\n\n// ==================== Tutor Routes ====================\nrouter.get(\n  PAYMENT_ROUTES.EARNINGS,\n  authMiddleware,\n  tutorMiddleware,\n  asyncHandler(PaymentController.getTutorEarnings)\n);\n\n// ==================== Admin Routes ====================\nrouter.get(\n  PAYMENT_ROUTES.ALL,\n  authMiddleware,\n  adminMiddleware,\n  asyncHandler(PaymentController.getAllPayments)\n);\n\n// ==================== Common Routes ====================\nrouter.get(\n  PAYMENT_ROUTES.BY_ID(\":id\"),\n  authMiddleware,\n  asyncHandler(PaymentController.getById)\n);\n\nexport default router;\n","// ==================== Dashboard Feature ====================\n// Combines all role-specific dashboard routes into a single router\nimport { Router, type IRouter } from \"express\";\nimport { PROFILE_ROUTES } from \"@/shared-types/dashboard/shared.js\";\nimport { authMiddleware, anyRoleMiddleware } from \"../auth/middleware.js\";\nimport { SharedDashboardController } from \"./shared.controller.js\";\nimport { adminDashboardRouter } from \"./admin/index.js\";\nimport { studentDashboardRouter } from \"./student/index.js\";\nimport { tutorDashboardRouter } from \"./tutor/index.js\";\n\nconst router = Router();\n\n// ==================== Shared Profile Routes (Any authenticated role) ====================\nrouter.get(\n    PROFILE_ROUTES.GET,\n    authMiddleware,\n    anyRoleMiddleware,\n    SharedDashboardController.getProfile\n);\nrouter.patch(\n    PROFILE_ROUTES.UPDATE,\n    authMiddleware,\n    anyRoleMiddleware,\n    SharedDashboardController.updateProfile\n);\n\n// ==================== Mount Role-Specific Routers ====================\n// Mount under root - each router has its own path prefix in its routes\nrouter.use(\"/admin\", adminDashboardRouter);\nrouter.use(\"/student\", studentDashboardRouter);\nrouter.use(\"/tutor\", tutorDashboardRouter);\n\nexport const dashboardRouter: IRouter = router;\n\n// Re-export role-specific exports\nexport { AdminDashboardController } from \"./admin/index.js\";\nexport { StudentDashboardController } from \"./student/index.js\";\nexport { TutorDashboardController } from \"./tutor/index.js\";\nexport { SharedDashboardController } from \"./shared.controller.js\";\nexport { adminDashboardRouter, studentDashboardRouter, tutorDashboardRouter };\n","// ==================== Shared Dashboard Routes ====================\nexport const PROFILE_ROUTES = {\n    GET: \"/profile/me\",\n    ME: \"/profile/me\",\n    UPDATE: \"/profile/update\",\n} as const;\n","// ==================== Shared Dashboard Controller ====================\n// Methods shared across all dashboard roles (student, tutor, admin)\nimport type { Response } from \"express\";\nimport { SUCCESS_MESSAGES } from \"../../shared/constants/index.js\";\nimport { sendNotFound, sendSuccess } from \"../../shared/utils/index.js\";\nimport { UserModel, type IUser } from \"../../shared/models/index.js\";\nimport type { AuthRequest } from \"../auth/types.js\";\n\n// ==================== Shared Dashboard Controller Class ====================\nexport class SharedDashboardController {\n    // ==================== Get Profile ====================\n    static async getProfile(req: AuthRequest, res: Response): Promise<void> {\n        const user = await UserModel.findByEmail(req.user!.email);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, user, \"Profile fetched successfully\");\n    }\n\n    // ==================== Update Profile ====================\n    static async updateProfile(req: AuthRequest, res: Response): Promise<void> {\n        const { name, phone, qualifications, experience, subjects, bio } = req.body;\n\n        const updateData: Partial<IUser> = {};\n        if (name !== undefined) updateData.name = name;\n        if (phone !== undefined) updateData.phone = phone;\n        if (qualifications !== undefined)\n            updateData.qualifications = qualifications;\n        if (experience !== undefined) updateData.experience = experience;\n        if (subjects !== undefined) updateData.subjects = subjects;\n        if (bio !== undefined) updateData.bio = bio;\n\n        const user = await UserModel.updateByEmail(req.user!.email, updateData);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, user, SUCCESS_MESSAGES.PROFILE_UPDATE);\n    }\n}\n","// ==================== Admin Dashboard Controller ====================\nimport type { Response } from \"express\";\nimport { WithId } from \"mongodb\";\nimport {\n    parsePagination,\n    sendNotFound,\n    sendPaginated,\n    sendSuccess,\n    toObjectId,\n} from \"../../../shared/utils/index.js\";\nimport {\n    UserModel,\n    TuitionModel,\n    type IPayment,\n    PaymentModel,\n    ApplicationModel,\n} from \"../../../shared/models/index.js\";\nimport type { AuthRequest } from \"../../auth/types.js\";\n\n// ==================== Types ====================\nexport interface DashboardStats {\n    totalUsers: number;\n    totalTuitions: number;\n    totalApplications: number;\n    totalPayments: number;\n    totalRevenue: number;\n    recentTransactions: WithId<IPayment>[];\n}\n\n// ==================== Admin Dashboard Controller Class ====================\nexport class AdminDashboardController {\n    // ==================== Get Dashboard Stats ====================\n    static async getDashboard(_req: AuthRequest, res: Response): Promise<void> {\n        const [\n            { total: totalUsers },\n            { total: totalTuitions },\n            { total: totalApplications },\n            { data: recentTransactions, total: totalPayments },\n            totalRevenue,\n        ] = await Promise.all([\n            UserModel.findAll({}, { limit: 0 }),\n            TuitionModel.findAll({}, { limit: 0 }),\n            ApplicationModel.findAll({}, { limit: 0 }),\n            PaymentModel.findAll({}, { limit: 10, sort: { createdAt: -1 } }),\n            PaymentModel.getPlatformEarnings(),\n        ]);\n\n        const stats: DashboardStats = {\n            totalUsers,\n            totalTuitions,\n            totalApplications,\n            totalPayments,\n            totalRevenue,\n            recentTransactions,\n        };\n\n        sendSuccess(res, stats, \"Dashboard stats fetched successfully\");\n    }\n\n    // ==================== Get Analytics Data ====================\n    static async getAnalytics(_req: AuthRequest, res: Response): Promise<void> {\n        sendSuccess(\n            res,\n            {\n                revenue: await PaymentModel.revenue(),\n                usersByRole: await UserModel.usersByRole(),\n                tuitionsByStatus: await TuitionModel.countByStatus(),\n                applicationsByStatus: await ApplicationModel.countByStatus(),\n            },\n            \"Analytics data fetched successfully\"\n        );\n    }\n\n    // ==================== Get All Users ====================\n    static async getUsers(req: AuthRequest, res: Response): Promise<void> {\n        const { page, limit, skip, sort } = parsePagination(\n            req.query as Record<string, string>\n        );\n        const { role, status, search } = req.query as Record<string, string>;\n\n        const query: Record<string, unknown> = {};\n\n        if (role) query.role = role;\n        if (status) query.status = status;\n        if (search) {\n            query.$or = [\n                { name: { $regex: search, $options: \"i\" } },\n                { email: { $regex: search, $options: \"i\" } },\n            ];\n        }\n\n        const { data: users, total } = await UserModel.findAll(query as Parameters<typeof UserModel.findAll>[0], { skip, limit, sort });\n\n        sendPaginated(res, users, page, limit, total);\n    }\n\n    // ==================== Get User by Email ====================\n    static async getUserByEmail(req: AuthRequest, res: Response): Promise<void> {\n        const { email } = req.params;\n        const user = await UserModel.findByEmail(email);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, user, \"User fetched successfully\");\n    }\n\n    // ==================== Update User Role ====================\n    static async updateUserRole(req: AuthRequest, res: Response): Promise<void> {\n        const { email } = req.params;\n        const { role } = req.body;\n\n        const user = await UserModel.updateRole(email, role);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, user, \"User role updated successfully\");\n    }\n\n    // ==================== Update User Status (Ban/Unban) ====================\n    static async updateUserStatus(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { email } = req.params;\n        const { status } = req.body;\n\n        const user = await UserModel.updateStatus(email, status);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, user, \"User status updated successfully\");\n    }\n\n    // ==================== Delete User ====================\n    static async deleteUser(req: AuthRequest, res: Response): Promise<void> {\n        const { email } = req.params;\n        const deleted = await UserModel.deleteByEmail(email);\n\n        if (!deleted) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n\n        sendSuccess(res, null, \"User deleted successfully\");\n    }\n\n    // ==================== Get All Tuitions ====================\n    static async getTuitions(req: AuthRequest, res: Response): Promise<void> {\n        const { page, limit, skip, sort } = parsePagination(\n            req.query as Record<string, string>\n        );\n        const { status, search } = req.query as Record<string, string>;\n\n        const query: Record<string, unknown> = {};\n\n        if (status) query.status = status;\n        if (search) {\n            query.$or = [\n                { subject: { $regex: search, $options: \"i\" } },\n                { location: { $regex: search, $options: \"i\" } },\n                { studentName: { $regex: search, $options: \"i\" } },\n            ];\n        }\n\n        const { data: tuitions, total } = await TuitionModel.findAll(query as Parameters<typeof TuitionModel.findAll>[0], { skip, limit, sort });\n\n        sendPaginated(res, tuitions, page, limit, total);\n    }\n\n    // ==================== Update Tuition Status (Approve/Reject) ====================\n    static async updateTuitionStatus(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { status } = req.body;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendNotFound(res, \"Invalid tuition ID\");\n            return;\n        }\n\n        const tuition = await TuitionModel.updateStatus(objectId, status);\n\n        if (!tuition) {\n            sendNotFound(res, \"Tuition not found\");\n            return;\n        }\n\n        sendSuccess(res, tuition, \"Tuition status updated successfully\");\n    }\n\n    // ==================== Get All Applications ====================\n    static async getApplications(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { page, limit, skip, sort } = parsePagination(\n            req.query as Record<string, string>\n        );\n        const { status } = req.query as Record<string, string>;\n\n        const query: Record<string, unknown> = {};\n\n        if (status) query.status = status;\n\n        const { data: applications, total } = await ApplicationModel.findAll(query as Parameters<typeof ApplicationModel.findAll>[0], { skip, limit, sort });\n\n        sendPaginated(res, applications, page, limit, total);\n    }\n\n    // ==================== Get All Payments ====================\n    static async getPayments(req: AuthRequest, res: Response): Promise<void> {\n        const { page, limit, skip, sort } = parsePagination(\n            req.query as Record<string, string>\n        );\n        const { status } = req.query as Record<string, string>;\n\n        const query: Record<string, unknown> = {};\n\n        if (status) query.status = status;\n\n        const { data: payments, total } = await PaymentModel.findAll(query as Parameters<typeof PaymentModel.findAll>[0], { skip, limit, sort });\n\n        sendPaginated(res, payments, page, limit, total);\n    }\n}\n","// ==================== Admin Dashboard Routes ====================\nimport { Router, type IRouter } from \"express\";\nimport {\n    ADMIN_ROUTES,\n    ADMIN_USER_ROUTES,\n    ADMIN_TUITION_ROUTES,\n    ADMIN_APPLICATION_ROUTES,\n    ADMIN_PAYMENT_ROUTES,\n} from \"@/shared-types/dashboard/admin.js\";\nimport { authMiddleware, adminMiddleware } from \"../../auth/middleware.js\";\nimport { AdminDashboardController } from \"./controller.js\";\n\nconst router = Router();\n\n// ==================== All routes require admin authentication ====================\nrouter.use(authMiddleware, adminMiddleware);\n\n// ==================== Dashboard Stats ====================\nrouter.get(\n    ADMIN_ROUTES.DASHBOARD,\n    AdminDashboardController.getDashboard\n);\n\nrouter.get(\n    ADMIN_ROUTES.ANALYTICS,\n    AdminDashboardController.getAnalytics\n);\n\n// ==================== User Management ====================\nrouter.get(\n    ADMIN_USER_ROUTES.ALL,\n    AdminDashboardController.getUsers\n);\nrouter.get(\n    ADMIN_USER_ROUTES.BY_ID(\":email\"),\n    AdminDashboardController.getUserByEmail\n);\nrouter.patch(\n    ADMIN_USER_ROUTES.UPDATE_ROLE(\":email\"),\n    AdminDashboardController.updateUserRole\n);\nrouter.patch(\n    `${ADMIN_USER_ROUTES.ALL}/:email/status`,\n    AdminDashboardController.updateUserStatus\n);\nrouter.delete(\n    ADMIN_USER_ROUTES.DELETE(\":email\"),\n    AdminDashboardController.deleteUser\n);\n\n// ==================== Tuition Management ====================\nrouter.get(\n    ADMIN_TUITION_ROUTES.ALL,\n    AdminDashboardController.getTuitions\n);\nrouter.patch(\n    `${ADMIN_TUITION_ROUTES.ALL}/:id/status`,\n    AdminDashboardController.updateTuitionStatus\n);\n\n// ==================== Application Management ====================\nrouter.get(\n    ADMIN_APPLICATION_ROUTES.ALL,\n    AdminDashboardController.getApplications\n);\n\n// ==================== Payment Management ====================\nrouter.get(\n    ADMIN_PAYMENT_ROUTES.ALL,\n    AdminDashboardController.getPayments\n);\n\nexport const adminDashboardRouter: IRouter = router;\n","// ==================== Admin Dashboard Routes ====================\nexport const ADMIN_ROUTES = {\n    DASHBOARD: \"/dashboard\",\n    ANALYTICS: \"/analytics\",\n} as const;\n\nexport const ADMIN_USER_ROUTES = {\n    ALL: \"/users\",\n    BY_ID: (uid: string) => `/users/${uid}`,\n    UPDATE_ROLE: (uid: string) => `/users/${uid}/role`,\n    DELETE: (uid: string) => `/users/${uid}`,\n} as const;\n\nexport const ADMIN_TUITION_ROUTES = {\n    ALL: \"/tuitions\",\n    BY_ID: (id: string) => `/tuitions/${id}`,\n    UPDATE_STATUS: (id: string) => `/tuitions/${id}/status`,\n} as const;\n\nexport const ADMIN_APPLICATION_ROUTES = {\n    ALL: \"/applications\",\n    BY_ID: (id: string) => `/applications/${id}`,\n} as const;\n\nexport const ADMIN_PAYMENT_ROUTES = {\n    ALL: \"/payments\",\n    BY_ID: (id: string) => `/payments/${id}`,\n} as const;\n","// ==================== Student Dashboard Controller ====================\nimport type { Response } from \"express\";\nimport { Filter } from \"mongodb\";\nimport { SUCCESS_MESSAGES } from \"../../../shared/constants/index.js\";\nimport {\n    parsePagination,\n    sendCreated,\n    sendError,\n    sendNotFound,\n    sendPaginated,\n    sendSuccess,\n    toObjectId,\n} from \"../../../shared/utils/index.js\";\nimport {\n    TuitionModel,\n    ApplicationModel,\n    PaymentModel,\n    type ITuition,\n    type ApplicationStatus,\n} from \"../../../shared/models/index.js\";\nimport type { AuthRequest } from \"../../auth/types.js\";\n\n// ==================== Student Dashboard Controller Class ====================\nexport class StudentDashboardController {\n    // ==================== Create Tuition ====================\n    static async createTuition(req: AuthRequest, res: Response): Promise<void> {\n        const {\n            subject,\n            class: className,\n            location,\n            budget,\n            schedule,\n            description,\n            requirements,\n        } = req.body;\n        const { email, name } = req.user!;\n\n        const tuition = await TuitionModel.create({\n            student: { email },\n            subject,\n            class: className,\n            location,\n            budget: Number(budget),\n            schedule,\n            description,\n            requirements,\n        });\n\n        sendCreated(res, tuition, SUCCESS_MESSAGES.TUITION_CREATED);\n    }\n\n    // ==================== Get My Tuitions ====================\n    static async getMyTuitions(req: AuthRequest, res: Response): Promise<void> {\n        const { skip, limit, page } = parsePagination(req.query);\n        const { email } = req.user!;\n        const {\n            subject,\n            class: className,\n            location,\n            status,\n            search,\n        } = req.query;\n\n        // Build filter\n        const filter: Filter<ITuition> = { studentId: email };\n\n        if (subject) filter.subject = { $regex: subject as string, $options: \"i\" };\n        if (className) filter.class = className as string;\n        if (location)\n            filter.location = { $regex: location as string, $options: \"i\" };\n        if (status) filter.status = status as ITuition[\"status\"];\n        if (search) {\n            filter.$or = [\n                { subject: { $regex: search as string, $options: \"i\" } },\n                { location: { $regex: search as string, $options: \"i\" } },\n                { class: { $regex: search as string, $options: \"i\" } },\n            ];\n        }\n\n        const { data: tuitions, total } = await TuitionModel.findByStudentId(email, {\n            skip,\n            limit,\n        });\n\n        sendPaginated(\n            res,\n            tuitions,\n            page,\n            limit,\n            total,\n            \"Your tuitions fetched successfully\"\n        );\n    }\n\n    // ==================== Update Tuition ====================\n    static async updateTuition(req: AuthRequest, res: Response): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n        const {\n            subject,\n            class: className,\n            location,\n            budget,\n            schedule,\n            description,\n            requirements,\n        } = req.body;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid tuition ID\");\n            return;\n        }\n\n        // Check ownership\n        const isOwner = await TuitionModel.isOwner(objectId, email);\n        if (!isOwner) {\n            sendError(res, \"You can only update your own tuitions\", 403);\n            return;\n        }\n\n        const updateData: Partial<ITuition> = {};\n        if (subject !== undefined) updateData.subject = subject;\n        if (className !== undefined) updateData.class = className;\n        if (location !== undefined) updateData.location = location;\n        if (budget !== undefined) updateData.budget = Number(budget);\n        if (schedule !== undefined) updateData.schedule = schedule;\n        if (description !== undefined) updateData.description = description;\n        if (requirements !== undefined) updateData.requirements = requirements;\n\n        const tuition = await TuitionModel.updateById(objectId, updateData);\n\n        if (!tuition) {\n            sendNotFound(res, \"Tuition not found\");\n            return;\n        }\n\n        sendSuccess(res, tuition, SUCCESS_MESSAGES.TUITION_UPDATED);\n    }\n\n    // ==================== Delete Tuition ====================\n    static async deleteTuition(req: AuthRequest, res: Response): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid tuition ID\");\n            return;\n        }\n\n        // Check ownership\n        const isOwner = await TuitionModel.isOwner(objectId, email);\n        if (!isOwner) {\n            sendError(res, \"You can only delete your own tuitions\", 403);\n            return;\n        }\n\n        // Delete associated applications\n        await ApplicationModel.deleteByTuitionId(objectId);\n\n        const deleted = await TuitionModel.deleteById(objectId);\n\n        if (!deleted) {\n            sendNotFound(res, \"Tuition not found\");\n            return;\n        }\n\n        sendSuccess(res, null, SUCCESS_MESSAGES.TUITION_DELETED);\n    }\n\n    // ==================== Get Applications For My Tuition ====================\n    static async getApplicationsForTuition(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { tuitionId } = req.params;\n        const { email } = req.user!;\n        const { skip, limit, page } = parsePagination(req.query);\n\n        const objectId = toObjectId(tuitionId);\n        if (!objectId) {\n            sendError(res, \"Invalid tuition ID\");\n            return;\n        }\n\n        // Check if tuition belongs to this student\n        const isOwner = await TuitionModel.isOwner(objectId, email);\n        if (!isOwner) {\n            sendError(res, \"You can only view applications for your own tuitions\", 403);\n            return;\n        }\n\n        const { data: applications, total } = await ApplicationModel.findByTuitionId(objectId, { skip, limit });\n\n        sendPaginated(res, applications, page, limit, total, \"Applications fetched successfully\");\n    }\n\n    // ==================== Accept Application ====================\n    static async acceptApplication(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid application ID\");\n            return;\n        }\n\n        // Get application\n        const application = await ApplicationModel.findById(objectId);\n        if (!application) {\n            sendNotFound(res, \"Application not found\");\n            return;\n        }\n\n        // Check if tuition belongs to this student\n        const tuition = await TuitionModel.findById(application.tuitionId);\n        if (!tuition || tuition.student.email !== email) {\n            sendError(res, \"You can only accept applications for your own tuitions\", 403);\n            return;\n        }\n\n        const updated = await ApplicationModel.updateStatus(objectId, \"accepted\" as ApplicationStatus);\n\n        sendSuccess(res, updated, \"Application accepted successfully\");\n    }\n\n    // ==================== Reject Application ====================\n    static async rejectApplication(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid application ID\");\n            return;\n        }\n\n        // Get application\n        const application = await ApplicationModel.findById(objectId);\n        if (!application) {\n            sendNotFound(res, \"Application not found\");\n            return;\n        }\n\n        // Check if tuition belongs to this student\n        const tuition = await TuitionModel.findById(application.tuitionId);\n        if (!tuition || tuition.student.email !== email) {\n            sendError(res, \"You can only reject applications for your own tuitions\", 403);\n            return;\n        }\n\n        const updated = await ApplicationModel.updateStatus(objectId, \"rejected\" as ApplicationStatus);\n\n        sendSuccess(res, updated, \"Application rejected successfully\");\n    }\n\n    // ==================== Get Payments ====================\n    static async getPayments(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { skip, limit, page } = parsePagination(req.query);\n        const { email } = req.user!;\n\n        const { data: payments, total } = await PaymentModel.findByStudentId(email, { skip, limit });\n\n        sendPaginated(\n            res,\n            payments,\n            page,\n            limit,\n            total,\n            \"Payments fetched successfully\"\n        );\n    }\n}\n","/**\n * Student Dashboard Routes\n * Handles all student-specific dashboard endpoints\n * Includes tuition posting, application management, and enrollment tracking\n * All routes require student role authentication\n */\n\n// ==================== Student Dashboard Routes ====================\nimport { Router, type IRouter } from \"express\";\nimport {\n    STUDENT_TUITION_ROUTES,\n    STUDENT_APPLICATION_ROUTES,\n    STUDENT_PAYMENT_ROUTES,\n} from \"@/shared-types/dashboard/student.js\";\nimport { authMiddleware, studentMiddleware } from \"../../auth/middleware.js\";\nimport { StudentDashboardController } from \"./controller.js\";\n\nconst router = Router();\n\n// ==================== All routes require student authentication ====================\n// Apply authentication middleware to all routes in this router\nrouter.use(authMiddleware, studentMiddleware);\n\n\n// ==================== Tuition Management ====================\n// POST /tuitions - Create a new tuition posting\nrouter.post(\n    STUDENT_TUITION_ROUTES.CREATE,\n    StudentDashboardController.createTuition\n);\n// GET /tuitions - Get all student's tuitions\nrouter.get(\n    STUDENT_TUITION_ROUTES.ALL,\n    StudentDashboardController.getMyTuitions\n);\n// GET /tuitions/my - Get all student's tuitions (alias)\nrouter.get(\n    STUDENT_TUITION_ROUTES.MY,\n    StudentDashboardController.getMyTuitions\n);\n// PATCH /tuitions/:id - Update tuition details\nrouter.patch(\n    STUDENT_TUITION_ROUTES.UPDATE(\":id\"),\n    StudentDashboardController.updateTuition\n);\n// DELETE /tuitions/:id - Delete tuition posting\nrouter.delete(\n    STUDENT_TUITION_ROUTES.DELETE(\":id\"),\n    StudentDashboardController.deleteTuition\n);\n\n\n// ==================== Application Management ====================\nrouter.get(\n    STUDENT_APPLICATION_ROUTES.BY_TUITION(\":tuitionId\"),\n    StudentDashboardController.getApplicationsForTuition\n);\nrouter.patch(\n    STUDENT_APPLICATION_ROUTES.ACCEPT(\":id\"),\n    StudentDashboardController.acceptApplication\n);\nrouter.patch(\n    STUDENT_APPLICATION_ROUTES.REJECT(\":id\"),\n    StudentDashboardController.rejectApplication\n);\n\n// ==================== Payment Management ====================\nrouter.get(\n    STUDENT_PAYMENT_ROUTES.ALL,\n    StudentDashboardController.getPayments\n);\n\nexport const studentDashboardRouter: IRouter = router;\n","// ==================== Student Dashboard Routes ====================\nexport const STUDENT_TUITION_ROUTES = {\n    ALL: \"/tuitions\",\n    MY: \"/tuitions/my\",\n    BY_ID: (id: string) => `/tuitions/${id}`,\n    CREATE: \"/tuitions/create\",\n    UPDATE: (id: string) => `/tuitions/${id}/update`,\n    DELETE: (id: string) => `/tuitions/${id}/delete`,\n} as const;\n\nexport const STUDENT_APPLICATION_ROUTES = {\n    BY_TUITION: (tuitionId: string) => `/tuitions/${tuitionId}/applications`,\n    ACCEPT: (applicationId: string) => `/applications/${applicationId}/accept`,\n    REJECT: (applicationId: string) => `/applications/${applicationId}/reject`,\n} as const;\n\nexport const STUDENT_PAYMENT_ROUTES = {\n    ALL: \"/payments\",\n    BY_ID: (id: string) => `/payments/${id}`,\n} as const;\n","// ==================== Tutor Dashboard Controller ====================\nimport type { Response } from \"express\";\nimport { SUCCESS_MESSAGES } from \"../../../shared/constants/index.js\";\nimport {\n    parsePagination,\n    sendCreated,\n    sendError,\n    sendNotFound,\n    sendPaginated,\n    sendSuccess,\n    toObjectId,\n} from \"../../../shared/utils/index.js\";\nimport {\n    TuitionModel,\n    ApplicationModel,\n    PaymentModel,\n    type IApplication,\n} from \"../../../shared/models/index.js\";\nimport type { AuthRequest } from \"../../auth/types.js\";\n\n// ==================== Tutor Dashboard Controller Class ====================\nexport class TutorDashboardController {\n    // ==================== Create Application ====================\n    static async createApplication(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const {\n            tuitionId,\n            qualifications,\n            experience,\n            expectedSalary,\n            coverLetter,\n        } = req.body;\n        const { email, name, picture } = req.user!;\n\n        const objectId = toObjectId(tuitionId);\n        if (!objectId) {\n            sendError(res, \"Invalid tuition ID\");\n            return;\n        }\n\n        // Check if tuition exists\n        const tuition = await TuitionModel.findById(objectId);\n        if (!tuition) {\n            sendNotFound(res, \"Tuition not found\");\n            return;\n        }\n\n        // Check if tuition is approved\n        if (tuition.status !== \"approved\") {\n            sendError(res, \"You can only apply to approved tuitions\", 400);\n            return;\n        }\n\n        // Check if already applied\n        const hasApplied = await ApplicationModel.hasApplied(objectId, email);\n        if (hasApplied) {\n            sendError(res, \"You have already applied to this tuition\", 400);\n            return;\n        }\n\n        // Create application\n        const application = await ApplicationModel.create({\n            tuitionId: objectId,\n            tutorId: email,\n            tutorEmail: email,\n            tutorName: name || \"Unknown\",\n            tutorPhotoUrl: picture,\n            qualifications,\n            experience,\n            expectedSalary: Number(expectedSalary),\n            coverLetter,\n        });\n\n        // Increment applications count\n        await TuitionModel.incrementApplicationsCount(objectId);\n\n        sendCreated(res, application, SUCCESS_MESSAGES.APPLICATION_SUBMITTED);\n    }\n\n    // ==================== Get My Applications ====================\n    static async getMyApplications(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { skip, limit, page } = parsePagination(req.query);\n        const { email } = req.user!;\n        const { status } = req.query;\n\n        const filter: Partial<IApplication> = { tutorId: email };\n        if (status) filter.status = status as IApplication[\"status\"];\n\n        const { data: applications, total } = await ApplicationModel.findByTutorId(\n            email,\n            { skip, limit }\n        );\n\n        sendPaginated(\n            res,\n            applications,\n            page,\n            limit,\n            total,\n            \"Your applications fetched successfully\"\n        );\n    }\n\n    // ==================== Get Application by ID ====================\n    static async getApplicationById(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid application ID\");\n            return;\n        }\n\n        const application = await ApplicationModel.findById(objectId);\n\n        if (!application) {\n            sendNotFound(res, \"Application not found\");\n            return;\n        }\n\n        // Check ownership\n        if (application.tutorId !== email) {\n            sendError(res, \"You can only view your own applications\", 403);\n            return;\n        }\n\n        sendSuccess(res, application, \"Application fetched successfully\");\n    }\n\n    // ==================== Update Application ====================\n    static async updateApplication(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n        const { qualifications, experience, expectedSalary, coverLetter } =\n            req.body;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid application ID\");\n            return;\n        }\n\n        // Check ownership\n        const isOwner = await ApplicationModel.isOwner(objectId, email);\n        if (!isOwner) {\n            sendError(res, \"You can only update your own applications\", 403);\n            return;\n        }\n\n        const updateData: Partial<IApplication> = {};\n        if (qualifications !== undefined)\n            updateData.qualifications = qualifications;\n        if (experience !== undefined) updateData.experience = experience;\n        if (expectedSalary !== undefined)\n            updateData.expectedSalary = Number(expectedSalary);\n        if (coverLetter !== undefined) updateData.coverLetter = coverLetter;\n\n        const application = await ApplicationModel.updateById(objectId, updateData);\n\n        if (!application) {\n            sendNotFound(res, \"Application not found\");\n            return;\n        }\n\n        sendSuccess(res, application, \"Application updated successfully\");\n    }\n\n    // ==================== Delete Application ====================\n    static async deleteApplication(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { id } = req.params;\n        const { email } = req.user!;\n\n        const objectId = toObjectId(id);\n        if (!objectId) {\n            sendError(res, \"Invalid application ID\");\n            return;\n        }\n\n        // Get application first\n        const application = await ApplicationModel.findById(objectId);\n        if (!application) {\n            sendNotFound(res, \"Application not found\");\n            return;\n        }\n\n        // Check ownership\n        if (application.tutorId !== email) {\n            sendError(res, \"You can only delete your own applications\", 403);\n            return;\n        }\n\n        // Delete application\n        await ApplicationModel.deleteById(objectId);\n\n        // Decrement applications count\n        await TuitionModel.decrementApplicationsCount(application.tuitionId);\n\n        sendSuccess(res, null, \"Application deleted successfully\");\n    }\n\n    // ==================== Get Ongoing Tuitions ====================\n    static async getOngoingTuitions(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { skip, limit, page } = parsePagination(req.query);\n        const { email } = req.user!;\n\n        // Get approved applications for this tutor\n        const { data: applications, total } = await ApplicationModel.findByTutorId(\n            email,\n            { skip, limit }\n        );\n\n        // Filter only approved applications and get tuition details\n        const approvedApplications = applications.filter(app => app.status === 'approved');\n\n        // Get tuition details for each approved application\n        const tuitionsWithDetails = await Promise.all(\n            approvedApplications.map(async (app) => {\n                const tuition = await TuitionModel.findById(app.tuitionId);\n                return tuition;\n            })\n        );\n\n        // Filter out null tuitions\n        const tuitions = tuitionsWithDetails.filter(t => t !== null);\n\n        sendPaginated(\n            res,\n            tuitions,\n            page,\n            limit,\n            tuitions.length,\n            \"Ongoing tuitions fetched successfully\"\n        );\n    }\n\n    // ==================== Get Earnings ====================\n    static async getEarnings(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { email } = req.user!;\n\n        // Get all payments for this tutor\n        const { data: payments } = await PaymentModel.findByTutorId(email);\n\n        // Calculate earnings\n        const completedPayments = payments.filter(p => p.status === 'completed');\n        const pendingPayments = payments.filter(p => p.status === 'pending');\n\n        const totalEarnings = completedPayments.reduce((sum, p) => sum + (p.tutorEarnings || p.amount), 0);\n        const pendingEarnings = pendingPayments.reduce((sum, p) => sum + (p.tutorEarnings || p.amount), 0);\n        const paidEarnings = totalEarnings;\n\n        sendSuccess(res, {\n            totalEarnings,\n            pendingEarnings,\n            paidEarnings,\n            transactions: payments,\n        }, \"Earnings fetched successfully\");\n    }\n\n    // ==================== Get Payments ====================\n    static async getPayments(\n        req: AuthRequest,\n        res: Response\n    ): Promise<void> {\n        const { skip, limit, page } = parsePagination(req.query);\n        const { email } = req.user!;\n\n        const { data: payments, total } = await PaymentModel.findByTutorId(email, { skip, limit });\n\n        sendPaginated(\n            res,\n            payments,\n            page,\n            limit,\n            total,\n            \"Payments fetched successfully\"\n        );\n    }\n}\n","// ==================== Tutor Dashboard Routes ====================\nimport { Router, type IRouter } from \"express\";\nimport { TUTOR_APPLICATION_ROUTES, TUTOR_TUITION_ROUTES, TUTOR_PAYMENT_ROUTES } from \"@/shared-types/dashboard/tutor.js\";\nimport { authMiddleware, tutorMiddleware } from \"../../auth/middleware.js\";\nimport { TutorDashboardController } from \"./controller.js\";\n\nconst router = Router();\n\n// ==================== All routes require tutor authentication ====================\nrouter.use(authMiddleware, tutorMiddleware);\n\n// ==================== Application Management ====================\nrouter.post(\n    TUTOR_APPLICATION_ROUTES.CREATE,\n    TutorDashboardController.createApplication\n);\nrouter.get(\n    TUTOR_APPLICATION_ROUTES.ALL,\n    TutorDashboardController.getMyApplications\n);\nrouter.get(\n    TUTOR_APPLICATION_ROUTES.MY,\n    TutorDashboardController.getMyApplications\n);\nrouter.get(\n    TUTOR_APPLICATION_ROUTES.BY_ID(\":id\"),\n    TutorDashboardController.getApplicationById\n);\nrouter.patch(\n    TUTOR_APPLICATION_ROUTES.UPDATE(\":id\"),\n    TutorDashboardController.updateApplication\n);\nrouter.delete(\n    TUTOR_APPLICATION_ROUTES.DELETE(\":id\"),\n    TutorDashboardController.deleteApplication\n);\n\n// ==================== Ongoing Tuitions ====================\nrouter.get(\n    TUTOR_TUITION_ROUTES.ONGOING,\n    TutorDashboardController.getOngoingTuitions\n);\n\n// ==================== Earnings & Payments ====================\nrouter.get(\n    TUTOR_PAYMENT_ROUTES.EARNINGS,\n    TutorDashboardController.getEarnings\n);\nrouter.get(\n    TUTOR_PAYMENT_ROUTES.HISTORY,\n    TutorDashboardController.getPayments\n);\n\nexport const tutorDashboardRouter: IRouter = router;\n","// ==================== Tutor Dashboard Routes ====================\nexport const TUTOR_APPLICATION_ROUTES = {\n    ALL: \"/applications\",\n    MY: \"/applications/my\",\n    BY_ID: (id: string) => `/applications/${id}`,\n    CREATE: \"/applications/create\",\n    UPDATE: (id: string) => `/applications/${id}/update`,\n    DELETE: (id: string) => `/applications/${id}/delete`,\n} as const;\n\nexport const TUTOR_TUITION_ROUTES = {\n    ONGOING: \"/tuitions/ongoing\",\n} as const;\n\nexport const TUTOR_PAYMENT_ROUTES = {\n    EARNINGS: \"/earnings\",\n    HISTORY: \"/payments\",\n} as const;\n","// ==================== Public Routes ====================\nimport { Router } from \"express\";\nimport { PUBLIC_TUITION_ROUTES, PUBLIC_TUTOR_ROUTES } from \"@/shared-types/public/index.js\";\nimport { asyncHandler, optionalAuth } from \"../../shared/middleware/index.js\";\nimport { PublicController } from \"./controller.js\";\n\nconst router: Router = Router();\n\n// ==================== Tuition Routes ====================\nrouter.get(\n    PUBLIC_TUITION_ROUTES.ALL,\n    optionalAuth,\n    asyncHandler(PublicController.getTuitions)\n);\n\nrouter.get(\n    PUBLIC_TUITION_ROUTES.FEATURED,\n    asyncHandler(PublicController.getFeaturedTuitions)\n);\n\nrouter.get(\n    PUBLIC_TUITION_ROUTES.FILTER_OPTIONS,\n    asyncHandler(PublicController.getFilterOptions)\n);\n\nrouter.get(\n    PUBLIC_TUITION_ROUTES.BY_ID(\":id\"),\n    optionalAuth,\n    asyncHandler(PublicController.getTuitionById)\n);\n\n// ==================== Tutor Routes ====================\nrouter.get(\n    PUBLIC_TUTOR_ROUTES.ALL,\n    optionalAuth,\n    asyncHandler(PublicController.getTutors)\n);\n\nrouter.get(\n    PUBLIC_TUTOR_ROUTES.FEATURED,\n    asyncHandler(PublicController.getFeaturedTutors)\n);\n\nrouter.get(\n    PUBLIC_TUTOR_ROUTES.FILTER_OPTIONS,\n    asyncHandler(PublicController.getTutorFilterOptions)\n);\n\nrouter.get(\n    PUBLIC_TUTOR_ROUTES.BY_ID(\":id\"),\n    optionalAuth,\n    asyncHandler(PublicController.getTutorById)\n);\n\nexport default router;\n","// ==================== Public Routes ====================\nexport const PUBLIC_TUITION_ROUTES = {\n    ALL: \"/tuitions\",\n    FEATURED: \"/tuitions/featured\",\n    FILTER_OPTIONS: \"/tuitions/filter-options\",\n    BY_ID: (id: string) => `/tuitions/${id}`,\n    SEARCH: \"/tuitions/search\",\n} as const;\n\nexport const PUBLIC_TUTOR_ROUTES = {\n    ALL: \"/tutors\",\n    FEATURED: \"/tutors/featured\",\n    FILTER_OPTIONS: \"/tutors/filter-options\",\n    BY_ID: (id: string) => `/tutors/${id}`,\n} as const;\n","// ==================== Public Controller ====================\n// Handles public routes (no auth required)\nimport { Request, Response } from \"express\";\nimport { TuitionModel, UserModel } from \"../../shared/models/index.js\";\nimport type { TuitionQuery } from \"../../shared/models/types.js\";\n\nexport class PublicController {\n    // ==================== Get All Tuitions ====================\n    static async getTuitions(req: Request, res: Response) {\n        const {\n            page = \"1\",\n            limit = \"10\",\n            sort = \"createdAt\",\n            order = \"desc\",\n            subject,\n            class: className,\n            location,\n            minBudget,\n            maxBudget,\n            search,\n        } = req.query as TuitionQuery;\n\n        const pageNum = parseInt(page, 10);\n        const limitNum = parseInt(limit, 10);\n        const skip = (pageNum - 1) * limitNum;\n\n        // Build filter - only approved tuitions are public\n        const filter: Record<string, unknown> = { status: \"approved\" };\n        if (subject && subject !== \"all\") filter.subject = { $regex: subject, $options: \"i\" };\n        if (className && className !== \"all\") filter.class = { $regex: className, $options: \"i\" };\n        if (location && location !== \"all\") filter.location = { $regex: location, $options: \"i\" };\n        if (minBudget || maxBudget) {\n            filter.budget = {};\n            if (minBudget) (filter.budget as Record<string, number>).$gte = parseInt(minBudget, 10);\n            if (maxBudget) (filter.budget as Record<string, number>).$lte = parseInt(maxBudget, 10);\n        }\n        if (search) {\n            filter.$or = [\n                { subject: { $regex: search, $options: \"i\" } },\n                { location: { $regex: search, $options: \"i\" } },\n                { class: { $regex: search, $options: \"i\" } },\n            ];\n        }\n\n        const sortOptions: Record<string, 1 | -1> = {\n            [sort]: order === \"asc\" ? 1 : -1,\n        };\n\n        const { data, total } = await TuitionModel.findAll(filter, {\n            skip,\n            limit: limitNum,\n            // sort: sortOptions, \n        });\n\n        res.json({\n            success: true,\n            data,\n            pagination: {\n                page: pageNum,\n                limit: limitNum,\n                total,\n                totalPages: Math.ceil(total / limitNum),\n            },\n        });\n    }\n\n    // ==================== Get Featured Tuitions ====================\n    static async getFeaturedTuitions(req: Request, res: Response) {\n        const { data } = await TuitionModel.findAll(\n            { status: \"approved\" },\n            { limit: 6, sort: { createdAt: -1 } }\n        );\n\n        res.json({ success: true, data });\n    }\n\n    // ==================== Get Tuition By ID ====================\n    static async getTuitionById(req: Request, res: Response) {\n        const { id } = req.params;\n        const tuition = await TuitionModel.findById(id);\n\n        if (!tuition) {\n            res.status(404).json({\n                success: false,\n                message: \"Tuition not found\",\n            });\n            return;\n        }\n\n        res.json({ success: true, data: tuition });\n    }\n\n    // ==================== Get Filter Options ====================\n    static async getFilterOptions(req: Request, res: Response) {\n        // Get distinct values from the database for approved tuitions only\n        const filter = { status: \"approved\" as const };\n\n        const [classes, subjects, locations] = await Promise.all([\n            TuitionModel.getDistinctValues(\"class\", filter),\n            TuitionModel.getDistinctValues(\"subject\", filter),\n            TuitionModel.getDistinctValues(\"location\", filter),\n        ]);\n\n        // Sort and format the options\n        const classOptions = [\"all\", ...classes.sort((a, b) => {\n            const numA = parseInt(a, 10);\n            const numB = parseInt(b, 10);\n            return numA - numB;\n        })];\n\n        const subjectOptions = [\"all\", ...subjects.sort()];\n        const locationOptions = [\"all\", ...locations.sort()];\n\n        res.json({\n            success: true,\n            data: {\n                classes: classOptions,\n                subjects: subjectOptions,\n                locations: locationOptions,\n            },\n        });\n    }\n\n    // ==================== Get All Tutors ====================\n    static async getTutors(req: Request, res: Response) {\n        const {\n            page = \"1\",\n            limit = \"10\",\n            sort = \"createdAt\",\n            order = \"desc\",\n            subject,\n            location,\n            experience,\n            search,\n        } = req.query as {\n            page?: string;\n            limit?: string;\n            sort?: string;\n            order?: string;\n            subject?: string;\n            location?: string;\n            experience?: string;\n            search?: string;\n        };\n\n        const pageNum = parseInt(page, 10);\n        const limitNum = parseInt(limit, 10);\n        const skip = (pageNum - 1) * limitNum;\n\n        // Build filter - only active tutors are public\n        const filter: Record<string, unknown> = { role: \"tutor\", status: \"active\" };\n\n        // Subject filter\n        if (subject && subject !== \"all\") {\n            filter.subjects = { $regex: subject, $options: \"i\" };\n        }\n\n        // Location filter\n        if (location && location !== \"all\") {\n            filter.location = { $regex: location, $options: \"i\" };\n        }\n\n        // Experience filter\n        if (experience && experience !== \"all\") {\n            const experienceNum = parseInt(experience.split(\"-\")[0] || \"0\", 10);\n            filter.experience = { $gte: experienceNum.toString() };\n        }\n\n        // Search filter\n        if (search) {\n            filter.$or = [\n                { name: { $regex: search, $options: \"i\" } },\n                { subjects: { $regex: search, $options: \"i\" } },\n                { qualifications: { $regex: search, $options: \"i\" } },\n                { bio: { $regex: search, $options: \"i\" } },\n            ];\n        }\n\n        // Sort options\n        const sortOptions: Record<string, 1 | -1> = {\n            [sort]: order === \"asc\" ? 1 : -1,\n        };\n\n        const { data, total } = await UserModel.findTutors(filter, {\n            skip,\n            limit: limitNum,\n            // sort: sortOptions,\n        });\n\n        res.json({\n            success: true,\n            data,\n            pagination: {\n                page: pageNum,\n                limit: limitNum,\n                total,\n                totalPages: Math.ceil(total / limitNum),\n            },\n        });\n    }\n\n    // ==================== Get Featured Tutors ====================\n    static async getFeaturedTutors(req: Request, res: Response) {\n        const { data } = await UserModel.findTutors(\n            { status: \"active\" },\n            { limit: 6 }\n        );\n\n        res.json({ success: true, data });\n    }\n\n    // ==================== Get Tutor By ID ====================\n    static async getTutorById(req: Request, res: Response) {\n        const { id } = req.params;\n        const tutor = await UserModel.findById(id);\n\n        if (!tutor || tutor.role !== \"tutor\") {\n            res.status(404).json({\n                success: false,\n                message: \"Tutor not found\",\n            });\n            return;\n        }\n\n        res.json({ success: true, data: tutor });\n    }\n\n    // ==================== Get Tutor Filter Options ====================\n    static async getTutorFilterOptions(req: Request, res: Response) {\n        // Get distinct values from the database for active tutors only\n        const filter = { role: \"tutor\" as const, status: \"active\" as const };\n\n        const [subjects, locations] = await Promise.all([\n            UserModel.getDistinctValues(\"subjects\", filter),\n            UserModel.getDistinctValues(\"location\", filter),\n        ]);\n\n        // Format the options\n        const subjectOptions = [\"all\", ...subjects.sort()];\n        const locationOptions = [\"all\", ...locations.filter(Boolean).sort()];\n        const experienceOptions = [\"all\", \"0-1\", \"1-2\", \"3-5\", \"5+\"];\n\n        res.json({\n            success: true,\n            data: {\n                subjects: subjectOptions,\n                locations: locationOptions,\n                experience: experienceOptions,\n            },\n        });\n    }\n}\n","// ==================== Review Routes ====================\nimport { Router } from \"express\";\nimport { REVIEW_ROUTES, CreateReviewSchema, UpdateReviewSchema } from \"@/shared-types/reviews/index.js\";\nimport {\n    asyncHandler,\n    authMiddleware,\n    validateBody,\n} from \"../../shared/middleware/index.js\";\nimport { ReviewController } from \"./controller.js\";\n\nconst router: Router = Router();\n\n// ==================== Review Routes ====================\n\n// Create review (authenticated students only)\nrouter.post(\n    REVIEW_ROUTES.CREATE,\n    authMiddleware,\n    validateBody(CreateReviewSchema),\n    asyncHandler(ReviewController.createReview)\n);\n\n// Get reviews by tutor (public)\nrouter.get(\n    REVIEW_ROUTES.GET_BY_TUTOR(\":tutorId\"),\n    asyncHandler(ReviewController.getReviewsByTutor)\n);\n\n// Get specific student review for tutor (public)\nrouter.get(\n    REVIEW_ROUTES.GET_STUDENT_REVIEW(\":tutorId\", \":studentId\"),\n    asyncHandler(ReviewController.getStudentReview)\n);\n\n// Update review (authenticated, owner only)\nrouter.put(\n    REVIEW_ROUTES.UPDATE(\":reviewId\"),\n    authMiddleware,\n    validateBody(UpdateReviewSchema),\n    asyncHandler(ReviewController.updateReview)\n);\n\n// Delete review (authenticated, owner only)\nrouter.delete(\n    REVIEW_ROUTES.DELETE(\":reviewId\"),\n    authMiddleware,\n    asyncHandler(ReviewController.deleteReview)\n);\n\n// Get tutor rating stats (public)\nrouter.get(\n    `/tutors/:tutorId/rating-stats`,\n    asyncHandler(ReviewController.getTutorRatingStats)\n);\n\nexport { router as reviewRouter };\n","// ==================== Review Validators ====================\nimport { z } from \"zod\";\n\nexport const CreateReviewSchema = z.object({\n    tutorId: z.string().min(1, \"Tutor ID is required\"),\n    rating: z.number().int().min(1, \"Rating must be at least 1\").max(5, \"Rating cannot exceed 5\"),\n    comment: z.string().min(5, \"Comment must be at least 5 characters\").max(500, \"Comment cannot exceed 500 characters\"),\n});\n\nexport const UpdateReviewSchema = z.object({\n    rating: z.number().int().min(1).max(5).optional(),\n    comment: z.string().min(5).max(500).optional(),\n});\n","// ==================== Reviews Routes ====================\nexport const REVIEW_ROUTES = {\n    CREATE: \"/reviews\",\n    GET_BY_TUTOR: (tutorId: string) => `/reviews/tutor/${tutorId}`,\n    GET_STUDENT_REVIEW: (tutorId: string, studentId: string) => `/reviews/tutor/${tutorId}/student/${studentId}`,\n    UPDATE: (reviewId: string) => `/reviews/${reviewId}`,\n    DELETE: (reviewId: string) => `/reviews/${reviewId}`,\n} as const;\n\n// ==================== Exports ====================\nexport * from \"./types.js\";\nexport * from \"./validators.js\";\n","// ==================== Review Controller ====================\nimport type { Response } from \"express\";\nimport { ReviewModel, UserModel } from \"../../shared/models/index.js\";\nimport {\n    sendCreated,\n    sendError,\n    sendNotFound,\n    sendSuccess,\n} from \"../../shared/utils/index.js\";\nimport { HTTP_STATUS } from \"../../shared/constants/index.js\";\nimport type { AuthRequest } from \"../auth/types.js\";\n\n// ==================== Review Controller Class ====================\nexport class ReviewController {\n    // ==================== Create Review ====================\n    static async createReview(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { tutorId, rating, comment } = req.body;\n            const studentId = req.user?.email;\n\n            if (!studentId) {\n                res.status(401).json({ error: \"Unauthorized\" });\n                return;\n            }\n\n            // Verify tutor exists\n            const tutor = await UserModel.findById(tutorId);\n            if (!tutor) {\n                sendNotFound(res, \"Tutor not found\");\n                return;\n            }\n\n            // Get student info\n            const student = await UserModel.findByEmail(studentId);\n            if (!student) {\n                sendNotFound(res, \"Student not found\");\n                return;\n            }\n\n            // Check if student already reviewed this tutor\n            const existingReview = await ReviewModel.findByTutorAndStudent(tutorId, studentId);\n            if (existingReview) {\n                res.status(409).json({ error: \"You have already reviewed this tutor\" });\n                return;\n            }\n\n            // Create review\n            const review = await ReviewModel.create({\n                tutorId,\n                studentId,\n                studentName: student.name || 'Anonymous',\n                studentPhoto: student.photoUrl || undefined,\n                rating,\n                comment,\n                createdAt: new Date(),\n                updatedAt: new Date(),\n            });\n\n            sendCreated(res, { review });\n        } catch (error) {\n            sendError(res, \"Failed to create review\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    // ==================== Get Reviews by Tutor ====================\n    static async getReviewsByTutor(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { tutorId } = req.params;\n            const skip = parseInt(req.query.skip as string) || 0;\n            const limit = parseInt(req.query.limit as string) || 10;\n\n            // Verify tutor exists\n            const tutor = await UserModel.findById(tutorId);\n            if (!tutor) {\n                sendNotFound(res, \"Tutor not found\");\n                return;\n            }\n\n            const { data, total } = await ReviewModel.findByTutor(tutorId, { skip, limit });\n\n            // Format response\n            const reviews = data.map((review) => ({\n                _id: review._id?.toString(),\n                student: {\n                    name: review.studentName,\n                    photo: review.studentPhoto,\n                },\n                rating: review.rating,\n                comment: review.comment,\n                createdAt: review.createdAt?.toISOString(),\n            }));\n\n            sendSuccess(res, { reviews, total, skip, limit });\n        } catch (error) {\n            sendError(res, \"Failed to fetch reviews\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    // ==================== Get Student's Review for Tutor ====================\n    static async getStudentReview(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { tutorId, studentId } = req.params;\n\n            const review = await ReviewModel.findByTutorAndStudent(tutorId, studentId);\n\n            if (!review) {\n                sendNotFound(res, \"Review not found\");\n                return;\n            }\n\n            const formattedReview = {\n                _id: review._id?.toString(),\n                student: {\n                    name: review.studentName,\n                    photo: review.studentPhoto,\n                },\n                rating: review.rating,\n                comment: review.comment,\n                createdAt: review.createdAt?.toISOString(),\n            };\n\n            sendSuccess(res, { review: formattedReview });\n        } catch (error) {\n            sendError(res, \"Failed to fetch review\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    // ==================== Update Review ====================\n    static async updateReview(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { reviewId } = req.params;\n            const { rating, comment } = req.body;\n            const studentId = req.user?.email;\n\n            if (!studentId) {\n                res.status(401).json({ error: \"Unauthorized\" });\n                return;\n            }\n\n            // Get review\n            const review = await ReviewModel.findById(reviewId);\n            if (!review) {\n                sendNotFound(res, \"Review not found\");\n                return;\n            }\n\n            // Check ownership\n            if (review.studentId !== studentId) {\n                res.status(403).json({ error: \"You can only update your own review\" });\n                return;\n            }\n\n            // Update review\n            const updatedReview = await ReviewModel.updateById(reviewId, {\n                rating: rating !== undefined ? rating : review.rating,\n                comment: comment !== undefined ? comment : review.comment,\n            });\n\n            sendSuccess(res, { review: updatedReview });\n        } catch (error) {\n            sendError(res, \"Failed to update review\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    // ==================== Delete Review ====================\n    static async deleteReview(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { reviewId } = req.params;\n            const studentId = req.user?.email;\n\n            if (!studentId) {\n                res.status(401).json({ error: \"Unauthorized\" });\n                return;\n            }\n\n            // Get review\n            const review = await ReviewModel.findById(reviewId);\n            if (!review) {\n                sendNotFound(res, \"Review not found\");\n                return;\n            }\n\n            // Check ownership\n            if (review.studentId !== studentId) {\n                res.status(403).json({ error: \"You can only delete your own review\" });\n                return;\n            }\n\n            // Delete review\n            const deleted = await ReviewModel.deleteById(reviewId);\n            if (!deleted) {\n                sendNotFound(res, \"Review not found\");\n                return;\n            }\n\n            sendSuccess(res, { message: \"Review deleted successfully\" });\n        } catch (error) {\n            sendError(res, \"Failed to delete review\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    // ==================== Get Tutor Rating Stats ====================\n    static async getTutorRatingStats(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            const { tutorId } = req.params;\n\n            // Verify tutor exists\n            const tutor = await UserModel.findById(tutorId);\n            if (!tutor) {\n                sendNotFound(res, \"Tutor not found\");\n                return;\n            }\n\n            const avgRating = await ReviewModel.getAverageRating(tutorId);\n            const reviewCount = await ReviewModel.getReviewCount(tutorId);\n\n            sendSuccess(res, { avgRating, reviewCount });\n        } catch (error) {\n            sendError(res, \"Failed to fetch rating stats\", HTTP_STATUS.INTERNAL_SERVER_ERROR);\n        }\n    }\n}\n","// ==================== Auth Routes ====================\nimport { AUTH_ROUTES } from \"@/shared-types/auth/index.js\";\nimport { Router } from \"express\";\nimport {\n  anyRoleMiddleware,\n  asyncHandler,\n  authMiddleware,\n  validateBody,\n} from \"../../shared/middleware/index.js\";\nimport { AuthController } from \"./controller.js\";\nimport { SignUpSchema } from \"@/shared-types/auth/index.js\";\nimport { guestMiddleware } from \"./middleware.js\";\n\nconst router: Router = Router();\n\n// ==================== Public Routes ====================\nrouter.post(\n  AUTH_ROUTES.SIGNUP,\n  guestMiddleware,\n  validateBody(SignUpSchema),\n  asyncHandler(AuthController.signUp)\n);\n\nrouter.post(\n  AUTH_ROUTES.SIGNIN,\n  guestMiddleware,\n  asyncHandler(AuthController.signIn)\n);\n\nrouter.post(\n  AUTH_ROUTES.GOOGLE,\n  guestMiddleware,\n  asyncHandler(AuthController.signInWithGooglePopup)\n);\n\n// ==================== Token Routes ====================\nrouter.post(\n  AUTH_ROUTES.SIGNOUT,\n  authMiddleware,\n  asyncHandler(AuthController.signOut)\n);\n\n// ==================== Protected Routes ====================\nrouter.get(\n  AUTH_ROUTES.ME,\n  authMiddleware,\n  asyncHandler(AuthController.getMe)\n);\n\n\nexport default router;\n","// ==================== Auth Controller ====================\n// Authentication methods for register, login, logout, token refresh\nimport type { Response } from \"express\";\nimport jwt from 'jsonwebtoken'\nimport bcrypt from 'bcrypt'\n\nimport { HTTP_STATUS, SUCCESS_MESSAGES } from \"../../shared/constants/index.js\";\nimport {\n    sendCreated,\n    sendError,\n    sendNotFound,\n    sendSuccess,\n} from \"../../shared/utils/index.js\";\nimport { UserModel, type IUser } from \"../../shared/models/index.js\";\nimport type { AuthRequest } from \"./types.js\";\nimport { firebase } from \"@/config/firebase.js\";\n\n\n// ==================== Auth Controller Class ====================\nexport class AuthController {\n    // ==================== Register ====================\n    static async signUp(req: AuthRequest, res: Response): Promise<void> {\n        const { name, email, phone, role, password } = req.body;\n\n        // Check if user exists\n        const existingUser = await UserModel.findByEmail(email);\n\n        if (existingUser) {\n            res.status(409).json({ error: \"Email already registered. Please login.\" });\n            return\n        }\n\n        // Create new user\n        const newUser = await UserModel.create({ email, name, phone, role, password, status: \"active\", createdAt: new Date(), updatedAt: new Date() });\n\n        const token = jwt.sign(\n            { email: newUser.email, role: newUser.role },\n            process.env.JWT_SECRET as string,\n            { expiresIn: \"7d\" }\n        );\n\n        // Set HttpOnly cookie\n        res.cookie(\"auth_token\", token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: process.env.NODE_ENV === 'production' ? \"none\" : \"lax\",\n            maxAge: 7 * 24 * 60 * 60 * 1000\n        });\n\n        res.status(201).json({\n            message: \"User registered successfully\",\n            user: { email, name, phone, role }\n        });\n    }\n\n    // ==================== Login ====================\n\n    static async signIn(req: AuthRequest, res: Response): Promise<void> {\n        const { email, password } = req.body;\n\n        // Find user\n        const user: IUser | null = await UserModel.findByEmail(email);\n        console.log(user);\n        \n        if (!user) {\n            sendError(res, \"Invalid email or password.\", HTTP_STATUS.UNAUTHORIZED);\n            return;\n        }\n\n        // Check banned status\n        if (user.status === \"banned\") {\n            sendError(res, \"Your account has been banned.\", HTTP_STATUS.FORBIDDEN);\n            return;\n        }\n\n        // Verify password (assuming bcrypt hash)\n        const isMatch = bcrypt.compare(password, user.password!);\n        if (!isMatch) {\n            sendError(res, \"Invalid email or password.\", HTTP_STATUS.UNAUTHORIZED);\n            return;\n        }\n\n        const { name, phone, role } = user\n\n        // Generate JWT\n        const token = jwt.sign(\n            { email, role },\n            process.env.JWT_SECRET as string,\n            { expiresIn: \"7d\" }\n        );\n\n        // Set HttpOnly cookie\n        res.cookie(\"auth_token\", token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: process.env.NODE_ENV === 'production' ? \"none\" : \"lax\",\n            maxAge: 7 * 24 * 60 * 60 * 1000\n        });\n\n        // Response (safe user object)\n        res.status(200).json({\n            success: true,\n            message: \"Login successful\",\n            user: { name, email, phone, role }\n\n        });\n    }\n\n    static async signInWithGooglePopup(req: AuthRequest, res: Response): Promise<void> {\n        try {\n            console.log('ðŸ” Google sign-in attempt started');\n            // Token header à¦¥à§‡à¦•à§‡ à¦¬à§‡à¦° à¦•à¦°à§‹\n            const authHeader = req.headers.authorization;\n            if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n                console.log('âŒ No Bearer token found');\n                sendError(res, \"No Google token provided.\", HTTP_STATUS.BAD_REQUEST);\n                return;\n            }\n            const token = authHeader.split(\" \")[1];\n            console.log('âœ… Token extracted, verifying...');\n\n            const { email, name } = await firebase.verifyToken(token);\n            console.log('âœ… Token verified, email:', email, 'name:', name);\n            if (!email) {\n                console.log('âŒ No email in token');\n                sendError(res, \"Token does not contain an email.\", HTTP_STATUS.BAD_REQUEST);\n                return;\n            }\n            let user = await UserModel.findByEmail(email);\n            if (!user) {\n                console.log('ðŸ” Creating new user for:', email);\n                user = await UserModel.create({\n                    name,\n                    email,\n                    role: 'student',\n                    status: \"active\",\n                    createdAt: new Date(),\n                    updatedAt: new Date()\n                });\n            } else {\n                console.log('âœ… Existing user found:', email);\n            }\n\n            // Generate JWT (minimal claims only)\n            const jwtToken = jwt.sign(\n                { email, role: 'student' },\n                process.env.JWT_SECRET as string,\n                { expiresIn: \"7d\" }\n            );\n            console.log('âœ… JWT generated');\n\n            // Set HttpOnly cookie\n            res.cookie(\"auth_token\", jwtToken, {\n                httpOnly: true,\n                secure: process.env.NODE_ENV === 'production',\n                sameSite: process.env.NODE_ENV === 'production' ? \"none\" : \"lax\",\n                maxAge: 7 * 24 * 60 * 60 * 1000\n            });\n\n            // Response\n            res.status(200).json({\n                success: true,\n                message: \"Google sign-in successful\",\n                data: {\n                    user: { name, email, role: 'student' }\n                }\n            });\n            console.log('âœ… Response sent successfully');\n        } catch (error) {\n            console.error('âŒ Google sign-in error:', error);\n            sendError(res, \"Google sign-in failed.\", HTTP_STATUS.UNAUTHORIZED);\n        }\n    }\n\n    // ==================== Logout ====================\n    static async signOut(_req: AuthRequest, res: Response): Promise<void> {\n        res.clearCookie(\"auth_token\", {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: process.env.NODE_ENV === 'production' ? \"none\" : \"lax\"\n        });\n\n        res.status(200).json({\n            success: true,\n            message: \"Logout successful\"\n        });\n    }\n\n\n    // ==================== Get Current User (Me) ====================\n    static async getMe(req: AuthRequest, res: Response): Promise<void> {\n        const user = await UserModel.findByEmail(req.user!.email);\n\n        if (!user) {\n            sendNotFound(res, \"User not found\");\n            return;\n        }\n        const { name, email, phone, role } = user;\n        sendSuccess(res, { user: { name, email, phone, role } }, \"User fetched successfully\");\n    }\n}\n"],"mappings":"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","names":["app","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","ObjectId","Router","Router","router","Router","Router","router","Router","app","Router","router","Router","router","Router","Router","router","Router","routes_default","Router","z","router","Router","Router","jwt","jwt","router","Router","routes_default","routes_default","router"]}